<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–î–®–í | –Ü–°–ü–ò–¢ –¶–ï–ù–¢–†</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* ===== –ß–ê–°–¢–ò–ù–ê 1: –ó–ú–Ü–ù–ù–Ü –¢–ê –ë–ê–ó–û–í–Ü –°–¢–ò–õ–Ü ===== */
        :root {
            --primary: #00ff44;
            --primary-bright: #e0ffe8;
            --primary-glow: rgba(0, 255, 68, 0.7);
            --bg: #030507;
            --card-bg: rgba(10, 12, 16, 0.6);
            --glass-border: rgba(0, 255, 68, 0.3);
            --danger: #ef4444;
            --danger-glow: rgba(239, 68, 68, 0.6);
            --warning: #fbbf24;
            --text-gray: #94a3b8;
            --blue: #3b82f6;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            background-color: var(--bg);
            background-image:
                radial-gradient(circle at 15% 50%, rgba(0,255,68,0.15), transparent 50%),
                radial-gradient(circle at 85% 30%, rgba(0,255,68,0.15), transparent 50%);
            background-attachment: fixed;
            color: white; font-family: 'Inter', sans-serif;
            min-height: 100vh; overflow-x: hidden;
            user-select: none; -webkit-user-select: none;
        }
        input, textarea, select { user-select: text !important; -webkit-user-select: text !important; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #05070a; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }
        a { color: var(--primary-bright); text-decoration: none; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 2: –ê–ù–Ü–ú–ê–¶–Ü–á ===== */
        @keyframes fadeInUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
        @keyframes modalPop { from { transform:scale(0.85); opacity:0; } to { transform:scale(1); opacity:1; } }
        @keyframes pulse { 0%{transform:scale(1);box-shadow:0 0 0 0 rgba(0,255,68,0.7)} 70%{transform:scale(1.05);box-shadow:0 0 0 10px rgba(0,255,68,0)} 100%{transform:scale(1);box-shadow:0 0 0 0 rgba(0,255,68,0)} }
        @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
        @keyframes spin { to { transform: rotate(360deg); } }
        .fade-in { animation: fadeInUp 0.4s ease forwards; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 3: –®–ê–ü–ö–ê ===== */
        header {
            display:flex; justify-content:space-between; align-items:center;
            padding:15px 5%; background:rgba(3,5,7,0.85);
            border-bottom:1px solid var(--glass-border);
            position:sticky; top:0; z-index:1000;
            box-shadow:0 0 20px rgba(0,255,68,0.15);
        }
        .logo-box {
            background:var(--primary); color:black; padding:6px 14px;
            border-radius:8px; font-weight:900; font-size:14px;
            text-transform:uppercase; text-decoration:none;
            box-shadow:0 0 15px var(--primary); cursor:pointer;
        }
        .header-right { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
        .nav-btn {
            background:rgba(255,255,255,0.05); border:1px solid var(--glass-border);
            color:var(--primary-bright); padding:8px 16px; border-radius:10px;
            font-weight:700; cursor:pointer; font-size:12px; transition:0.3s;
        }
        .nav-btn:hover { background:var(--primary); color:black; box-shadow:0 0 15px var(--primary); }
        .nav-btn.active { background:var(--primary); color:black; box-shadow:0 0 15px var(--primary); }
        .role-badge {
            padding:6px 14px; border-radius:8px; font-weight:900; font-size:11px;
            text-transform:uppercase; letter-spacing:1px;
        }
        .role-admin { background:var(--primary); color:black; }
        .role-user { background:rgba(255,255,255,0.1); color:var(--text-gray); border:1px solid #333; }
        .user-name-header { color:var(--primary-bright); font-weight:800; font-size:13px; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 4: –ù–û–¢–ò–§–Ü–ö–ê–¶–Ü–á ===== */
        .notif-wrapper { position:relative; cursor:pointer; padding:5px; }
        .bell-icon { font-size:22px; color:var(--warning); }
        .bell-badge {
            position:absolute; top:-2px; right:-2px;
            background:var(--danger); color:white; font-size:9px; font-weight:900;
            padding:2px 6px; border-radius:50%; display:none;
            animation: pulse 1.5s infinite;
        }
        .notif-dropdown {
            position:absolute; top:55px; right:5%; width:360px;
            background:rgba(10,15,25,0.97); border:1px solid var(--glass-border);
            border-radius:15px; display:none; flex-direction:column;
            z-index:2000; box-shadow:0 0 40px rgba(0,0,0,0.9); overflow:hidden;
        }
        .notif-dropdown.open { display:flex; }
        .notif-header-bar { padding:12px 15px; background:rgba(255,255,255,0.05); display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid var(--glass-border); }
        .notif-item { padding:12px 15px; border-bottom:1px solid rgba(255,255,255,0.05); font-size:12px; cursor:pointer; }
        .notif-item:hover { background:rgba(255,255,255,0.05); }
        .notif-item.read { opacity:0.4; }
        .notif-time { font-size:10px; color:var(--text-gray); margin-top:4px; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 5: –ö–û–ù–¢–ï–ù–¢ ===== */
        .content { padding:30px 5%; max-width:1200px; margin:0 auto; }
        .view { display:none; }
        .view.active { display:block; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 6: –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===== */
        .stats-row { display:grid; grid-template-columns:repeat(4,1fr); gap:15px; margin-bottom:30px; }
        .stat-card {
            background:var(--card-bg); border:1px solid var(--glass-border);
            border-radius:15px; padding:20px; text-align:center;
            backdrop-filter:blur(10px);
        }
        .stat-card .stat-num { font-size:28px; font-weight:900; color:var(--primary-bright); }
        .stat-card .stat-label { font-size:10px; color:var(--text-gray); text-transform:uppercase; margin-top:5px; font-weight:700; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 7: –ö–ê–†–¢–ö–ò –¢–ï–°–¢–Ü–í ===== */
        .tests-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr)); gap:20px; margin-bottom:30px; }
        .test-card {
            background:var(--card-bg); border:1px solid var(--glass-border);
            border-radius:20px; padding:25px; cursor:pointer;
            backdrop-filter:blur(10px); transition:0.3s; position:relative; overflow:hidden;
        }
        .test-card:hover { transform:translateY(-3px); border-color:var(--primary); box-shadow:0 0 30px var(--primary-glow); }
        .test-card .emoji { font-size:40px; margin-bottom:12px; display:block; }
        .test-card .title { font-size:18px; font-weight:900; margin-bottom:8px; }
        .test-card .desc { font-size:12px; color:var(--text-gray); margin-bottom:12px; line-height:1.5; }
        .test-card .meta { display:flex; gap:10px; flex-wrap:wrap; }
        .tag { padding:4px 10px; border-radius:6px; font-size:10px; font-weight:800; }
        .tag-green { background:rgba(0,255,68,0.15); color:var(--primary); }
        .tag-yellow { background:rgba(251,191,36,0.15); color:var(--warning); }
        .tag-blue { background:rgba(59,130,246,0.15); color:var(--blue); }
        .tag-red { background:rgba(239,68,68,0.15); color:var(--danger); }

        /* ===== –ß–ê–°–¢–ò–ù–ê 8: –°–ï–ö–¶–Ü–Ø ===== */
        .section-title { font-size:16px; font-weight:900; color:var(--primary-bright); margin-bottom:20px; text-transform:uppercase; letter-spacing:1px; }
        .section-box {
            background:var(--card-bg); border:1px solid var(--glass-border);
            border-radius:20px; padding:25px; margin-bottom:20px;
            backdrop-filter:blur(10px);
        }

        /* ===== –ß–ê–°–¢–ò–ù–ê 9: –Ü–ù–¢–†–û –¢–ï–°–¢–£ ===== */
        .intro-box {
            background:var(--card-bg); border:1px solid var(--primary);
            border-radius:25px; padding:40px; max-width:600px; margin:0 auto;
            text-align:center; box-shadow:0 0 40px rgba(0,255,68,0.2);
        }
        .intro-box .emoji { font-size:60px; margin-bottom:20px; }
        .intro-box .title { font-size:28px; font-weight:900; margin-bottom:10px; }
        .intro-box .desc { color:var(--text-gray); margin-bottom:25px; font-size:14px; line-height:1.6; }
        .intro-info { display:flex; justify-content:center; gap:20px; margin-bottom:30px; flex-wrap:wrap; }
        .intro-info .tag { padding:8px 16px; font-size:12px; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 10: –ü–†–û–•–û–î–ñ–ï–ù–ù–Ø –¢–ï–°–¢–£ ===== */
        .test-container { max-width:700px; margin:0 auto; }
        .progress-bar-wrap { background:#111; border-radius:10px; height:8px; margin-bottom:20px; overflow:hidden; }
        .progress-bar-fill { height:100%; background:var(--primary); border-radius:10px; transition:width 0.5s; box-shadow:0 0 10px var(--primary); }
        .question-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; }
        .q-counter { font-size:13px; color:var(--text-gray); font-weight:700; }
        .timer { font-size:14px; font-weight:900; color:var(--warning); }
        .timer.danger { color:var(--danger); animation:shake 0.3s infinite; }
        .question-text {
            font-size:20px; font-weight:800; margin-bottom:25px; line-height:1.4;
            padding:20px; background:rgba(255,255,255,0.03); border-radius:15px;
            border:1px solid rgba(255,255,255,0.05);
        }
        .answers-list { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
        .answer-btn {
            background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.1);
            color:white; padding:16px 20px; border-radius:12px; cursor:pointer;
            font-size:14px; font-weight:600; text-align:left; transition:0.3s;
            display:flex; align-items:center; gap:12px;
        }
        .answer-btn:hover { border-color:var(--primary); background:rgba(0,255,68,0.08); }
        .answer-btn.selected { border-color:var(--primary); background:rgba(0,255,68,0.15); box-shadow:0 0 15px var(--primary-glow); }
        .answer-btn.correct { border-color:var(--primary); background:rgba(0,255,68,0.2); }
        .answer-btn.wrong { border-color:var(--danger); background:rgba(239,68,68,0.2); }
        .answer-letter {
            width:32px; height:32px; border-radius:8px; display:flex; align-items:center; justify-content:center;
            font-weight:900; font-size:13px; background:rgba(255,255,255,0.1); flex-shrink:0;
        }
        .answer-btn.selected .answer-letter { background:var(--primary); color:black; }
        .answer-btn.correct .answer-letter { background:var(--primary); color:black; }
        .answer-btn.wrong .answer-letter { background:var(--danger); color:white; }
        .free-answer-area {
            width:100%; background:#0a0c10; border:1px solid rgba(255,255,255,0.1);
            color:white; padding:15px; border-radius:12px; font-size:14px;
            font-family:'Inter',sans-serif; resize:vertical; min-height:80px; outline:none;
        }
        .free-answer-area:focus { border-color:var(--primary); box-shadow:0 0 15px var(--primary-glow); }
        .free-label { font-size:12px; color:var(--primary-bright); font-weight:700; margin-bottom:8px; text-transform:uppercase; }

        .btn-confirm {
            width:100%; padding:16px; background:var(--primary); color:black;
            border:none; border-radius:12px; font-weight:900; font-size:14px;
            cursor:pointer; text-transform:uppercase; margin-top:10px;
        }
        .btn-confirm:hover { box-shadow:0 0 25px var(--primary); }
        .btn-confirm:disabled { opacity:0.3; cursor:not-allowed; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 11: –†–ï–ó–£–õ–¨–¢–ê–¢–ò ===== */
        .result-box {
            max-width:650px; margin:0 auto; text-align:center;
            background:var(--card-bg); border-radius:25px; padding:40px;
            border:1px solid var(--glass-border);
        }
        .result-box.passed { border-color:var(--primary); box-shadow:0 0 40px rgba(0,255,68,0.3); }
        .result-box.failed { border-color:var(--danger); box-shadow:0 0 40px var(--danger-glow); }
        .result-score { font-size:60px; font-weight:900; margin:15px 0; }
        .result-box.passed .result-score { color:var(--primary); text-shadow:0 0 30px var(--primary); }
        .result-box.failed .result-score { color:var(--danger); text-shadow:0 0 30px var(--danger); }
        .result-status { font-size:22px; font-weight:900; margin-bottom:5px; }
        .result-sub { font-size:13px; color:var(--text-gray); margin-bottom:25px; }
        .result-details { text-align:left; margin-top:25px; }
        .result-q-item {
            padding:15px; background:rgba(255,255,255,0.03); border-radius:12px;
            margin-bottom:10px; border-left:4px solid #333;
        }
        .result-q-item.q-correct { border-left-color:var(--primary); }
        .result-q-item.q-wrong { border-left-color:var(--danger); }
        .result-q-item.q-pending { border-left-color:var(--warning); }
        .result-q-text { font-size:13px; font-weight:700; margin-bottom:6px; }
        .result-q-answer { font-size:12px; color:var(--text-gray); }
        .result-btns { display:flex; gap:10px; margin-top:25px; justify-content:center; flex-wrap:wrap; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 12: –§–û–†–ú–ê –°–¢–í–û–†–ï–ù–ù–Ø/–†–ï–î–ê–ì–£–í–ê–ù–ù–Ø ===== */
        .form-box { max-width:800px; margin:0 auto; }
        .form-group { margin-bottom:20px; }
        .form-label { display:block; font-size:11px; color:var(--text-gray); margin-bottom:8px; text-transform:uppercase; font-weight:700; letter-spacing:1px; }
        .form-input, .form-select {
            width:100%; background:#0a0c10; border:1px solid #222; color:white;
            padding:12px 15px; border-radius:10px; font-size:14px; font-family:'Inter',sans-serif; outline:none;
        }
        .form-input:focus, .form-select:focus { border-color:var(--primary); box-shadow:0 0 10px var(--primary-glow); }
        .form-textarea { min-height:70px; resize:vertical; }
        .form-row { display:grid; grid-template-columns:1fr 1fr; gap:15px; }
        .form-row-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:15px; }

        .question-block {
            background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.08);
            border-radius:15px; padding:20px; margin-bottom:15px; position:relative;
        }
        .question-block .q-num { font-size:11px; color:var(--primary); font-weight:900; margin-bottom:10px; text-transform:uppercase; }
        .variant-row {
            display:flex; align-items:center; gap:10px; margin-bottom:8px;
        }
        .variant-row input[type="text"] {
            flex:1; background:#0a0c10; border:1px solid #222; color:white;
            padding:10px; border-radius:8px; font-size:13px; outline:none; font-family:'Inter',sans-serif;
        }
        .variant-row input[type="text"]:focus { border-color:var(--primary); }
        .radio-correct {
            width:20px; height:20px; border-radius:50%; border:2px solid #444;
            cursor:pointer; background:none; flex-shrink:0; transition:0.3s; appearance:none; -webkit-appearance:none;
        }
        .radio-correct:checked { background:var(--primary); border-color:var(--primary); box-shadow:0 0 10px var(--primary); }
        .btn-remove-variant {
            background:none; border:none; color:#555; cursor:pointer; font-size:18px; padding:5px;
        }
        .btn-remove-variant:hover { color:var(--danger); }
        .btn-add-small {
            background:none; border:1px dashed #333; color:var(--text-gray);
            padding:8px 15px; border-radius:8px; cursor:pointer; font-size:12px; font-weight:700;
            margin-top:5px; margin-right:8px;
        }
        .btn-add-small:hover { border-color:var(--primary); color:var(--primary); }
        .btn-remove-q {
            position:absolute; top:12px; right:15px; background:none; border:none;
            color:#444; cursor:pointer; font-size:20px;
        }
        .btn-remove-q:hover { color:var(--danger); }
        .btn-add-question {
            width:100%; padding:15px; background:none; border:2px dashed var(--glass-border);
            color:var(--primary); border-radius:15px; cursor:pointer; font-weight:800;
            font-size:13px; margin-bottom:20px;
        }
        .btn-add-question:hover { border-color:var(--primary); background:rgba(0,255,68,0.05); }
        .toggle-row { display:flex; align-items:center; gap:10px; margin-top:8px; }
        .toggle-label { font-size:11px; color:var(--text-gray); font-weight:700; }
        .toggle-switch {
            width:36px; height:20px; background:#333; border-radius:10px; cursor:pointer;
            position:relative; border:none; transition:0.3s;
        }
        .toggle-switch.on { background:var(--primary); }
        .toggle-switch::after {
            content:''; position:absolute; top:2px; left:2px; width:16px; height:16px;
            background:white; border-radius:50%; transition:0.3s;
        }
        .toggle-switch.on::after { left:18px; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 13: –ü–ï–†–ï–í–Ü–†–ö–ê ===== */
        .review-card {
            background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08);
            border-radius:15px; padding:20px; margin-bottom:15px;
        }
        .review-card .review-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; flex-wrap:wrap; gap:10px; }
        .review-q { padding:12px; background:rgba(0,0,0,0.3); border-radius:10px; margin-bottom:10px; }
        .review-q .q-text { font-size:13px; font-weight:700; margin-bottom:5px; }
        .review-q .q-answer { font-size:12px; color:var(--warning); }
        .review-q .q-correct-ans { font-size:11px; color:var(--primary); margin-top:3px; }
        .review-btns { display:flex; gap:10px; }
        .btn-approve { background:var(--primary); color:black; border:none; padding:10px 20px; border-radius:10px; font-weight:800; cursor:pointer; font-size:12px; }
        .btn-reject { background:none; border:1px solid var(--danger); color:var(--danger); padding:10px 20px; border-radius:10px; font-weight:800; cursor:pointer; font-size:12px; }
        .btn-approve:hover { box-shadow:0 0 15px var(--primary); }
        .btn-reject:hover { background:var(--danger); color:white; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 14: –ù–ê–°–¢–†–û–ô–ö–ò ===== */
        .settings-grid { display:grid; grid-template-columns:1fr 1fr; gap:20px; }
        .checker-item {
            display:flex; justify-content:space-between; align-items:center;
            padding:10px 15px; background:rgba(255,255,255,0.03); border-radius:10px;
            margin-bottom:8px; border:1px solid rgba(255,255,255,0.05);
        }
        .checker-item .name { font-size:13px; font-weight:700; }
        .checker-item .role-tag { font-size:10px; padding:3px 8px; border-radius:5px; font-weight:800; }
        .btn-remove-checker { background:none; border:none; color:#555; cursor:pointer; font-size:16px; }
        .btn-remove-checker:hover { color:var(--danger); }
        .user-select-dropdown {
            position:absolute; top:100%; left:0; right:0; background:#0f1115;
            border:1px solid var(--glass-border); border-radius:10px; max-height:200px;
            overflow-y:auto; z-index:100; display:none;
        }
        .user-select-dropdown.open { display:block; }
        .user-select-item {
            padding:10px 15px; cursor:pointer; font-size:13px; display:flex;
            justify-content:space-between; align-items:center; border-bottom:1px solid rgba(255,255,255,0.05);
        }
        .user-select-item:hover { background:rgba(0,255,68,0.1); }
        .search-input-wrap { position:relative; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 15: –ö–ù–û–ü–ö–ò ===== */
        .btn-primary { background:var(--primary); color:black; border:none; padding:14px 30px; border-radius:12px; font-weight:900; cursor:pointer; font-size:13px; text-transform:uppercase; }
        .btn-primary:hover { box-shadow:0 0 20px var(--primary); }
        .btn-secondary { background:rgba(255,255,255,0.05); color:white; border:1px solid var(--glass-border); padding:14px 30px; border-radius:12px; font-weight:900; cursor:pointer; font-size:13px; }
        .btn-secondary:hover { border-color:var(--primary); color:var(--primary-bright); }
        .btn-danger { background:none; border:1px solid var(--danger); color:var(--danger); padding:10px 20px; border-radius:10px; font-weight:800; cursor:pointer; font-size:12px; }
        .btn-danger:hover { background:var(--danger); color:white; }
        .btn-edit { background:none; border:1px solid var(--warning); color:var(--warning); padding:8px 16px; border-radius:8px; font-weight:800; cursor:pointer; font-size:11px; }
        .btn-edit:hover { background:var(--warning); color:black; }

        /* ===== –ß–ê–°–¢–ò–ù–ê 16: –ö–ï–†–£–í–ê–ù–ù–Ø ===== */
        .manage-table { width:100%; border-collapse:collapse; }
        .manage-table th { text-align:left; padding:12px 15px; font-size:11px; color:var(--text-gray); text-transform:uppercase; border-bottom:1px solid #222; font-weight:800; }
        .manage-table td { padding:12px 15px; font-size:13px; border-bottom:1px solid rgba(255,255,255,0.05); }
        .manage-table tr:hover td { background:rgba(255,255,255,0.02); }

        /* ===== –ß–ê–°–¢–ò–ù–ê 17: –ú–û–î–ê–õ–ö–ê ===== */
        .modal-overlay {
            position:fixed; top:0; left:0; width:100%; height:100%;
            background:rgba(0,0,0,0.9); display:none; justify-content:center; align-items:center; z-index:3000;
        }
        .modal-overlay.open { display:flex; }
        .modal-content {
            background:#0f1115; border:1px solid var(--glass-border);
            padding:30px; border-radius:20px; width:90%; max-width:500px;
            position:relative; box-shadow:0 0 60px rgba(0,255,68,0.3);
            animation:modalPop 0.3s ease; max-height:90vh; overflow-y:auto;
        }
        .modal-close { position:absolute; top:12px; right:18px; background:none; border:none; color:#555; font-size:24px; cursor:pointer; }
        .modal-close:hover { color:white; transform:rotate(90deg); }

        /* ===== –ß–ê–°–¢–ò–ù–ê 18: –ê–î–ê–ü–¢–ò–í ===== */
        @media(max-width:768px) {
            .stats-row { grid-template-columns:1fr 1fr; }
            .tests-grid { grid-template-columns:1fr; }
            .form-row, .form-row-3 { grid-template-columns:1fr; }
            .settings-grid { grid-template-columns:1fr; }
            header { padding:12px 15px; }
            .content { padding:20px 15px; }
            .intro-box { padding:25px; }
            .question-text { font-size:16px; }
            .result-score { font-size:45px; }
            .nav-btn { padding:6px 10px; font-size:11px; }
        }
        @media(max-width:480px) {
            .stats-row { grid-template-columns:1fr; }
        }

        /* ===== –ß–ê–°–¢–ò–ù–ê 19: –†–ï–ó–£–õ–¨–¢–ê–¢–ò –¢–ê–ë–õ–ò–¶–Ø ===== */
        .results-list { margin-top:15px; }
        .result-item {
            display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px;
            padding:15px; background:rgba(255,255,255,0.03); border-radius:12px;
            margin-bottom:8px; border:1px solid rgba(255,255,255,0.05);
        }
        .result-item .ri-name { font-weight:700; font-size:14px; }
        .result-item .ri-score { font-weight:900; font-size:14px; }
        .result-item .ri-date { font-size:11px; color:var(--text-gray); }
        .result-item .ri-status { font-size:11px; font-weight:800; padding:4px 10px; border-radius:6px; }
        .ri-passed { background:rgba(0,255,68,0.15); color:var(--primary); }
        .ri-failed { background:rgba(239,68,68,0.15); color:var(--danger); }
        .ri-pending { background:rgba(251,191,36,0.15); color:var(--warning); }
        .ri-approved { background:rgba(0,255,68,0.15); color:var(--primary); }
        .ri-rejected { background:rgba(239,68,68,0.15); color:var(--danger); }
        .reviewer-name { font-size:11px; color:var(--blue); font-weight:700; }
    </style>
</head>
<body>

    <!-- ===== HEADER ===== -->
    <header>
        <a href="cabinet.html" class="logo-box">–î–®–í</a>
        <div class="header-right">
            <button class="nav-btn active" onclick="navigate('home')">üè† –ì–æ–ª–æ–≤–Ω–∞</button>
            <button class="nav-btn" onclick="navigate('create')" id="navCreate" style="display:none;">‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏</button>
            <button class="nav-btn" onclick="navigate('review')" id="navReview" style="display:none;">üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ <span id="reviewBadge" style="display:none;color:var(--danger);font-weight:900;"> ‚óè</span></button>
            <button class="nav-btn" onclick="navigate('manage')" id="navManage" style="display:none;">‚öôÔ∏è –ö–µ—Ä—É–≤–∞–Ω–Ω—è</button>
            <button class="nav-btn" onclick="navigate('settings')" id="navSettings" style="display:none;">üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <div class="notif-wrapper" onclick="toggleNotifPanel(event)">
                <span class="bell-icon">üîî</span>
                <div id="notifBadge" class="bell-badge">0</div>
            </div>
            <span class="user-name-header" id="headerUserName">---</span>
            <span class="role-badge role-user" id="headerRole">–ë–Ü–Ñ–¶–¨</span>
        </div>
    </header>

    <!-- ===== –ù–û–¢–ò–§–Ü–ö–ê–¶–Ü–á –î–†–û–ü–î–ê–£–ù ===== -->
    <div class="notif-dropdown" id="notifDropdown">
        <div class="notif-header-bar">
            <span style="color:var(--primary-bright);font-size:12px;font-weight:800;">–°–ü–û–í–Ü–©–ï–ù–ù–Ø</span>
            <button onclick="clearNotifs()" style="background:none;border:none;color:var(--text-gray);font-size:10px;cursor:pointer;font-weight:700;">–û–ß–ò–°–¢–ò–¢–ò</button>
        </div>
        <div id="notifList">
            <div class="notif-item" style="text-align:center;color:var(--text-gray);">–ù–µ–º–∞—î —Å–ø–æ–≤—ñ—â–µ–Ω—å</div>
        </div>
    </div>

    <div class="content">

        <!-- ===== VIEW: –ì–û–õ–û–í–ù–ê ===== -->
        <div class="view active" id="viewHome">
            <div class="stats-row" id="statsRow"></div>
            <div class="section-title">üìö –î–û–°–¢–£–ü–ù–Ü –¢–ï–°–¢–ò</div>
            <div class="tests-grid" id="testsGrid"></div>
            <div class="section-title" style="margin-top:30px;">üìä –ú–û–á –†–ï–ó–£–õ–¨–¢–ê–¢–ò</div>
            <div id="myResults"></div>
        </div>

        <!-- ===== VIEW: –Ü–ù–¢–†–û –¢–ï–°–¢–£ ===== -->
        <div class="view" id="viewIntro">
            <div class="intro-box fade-in" id="introContent"></div>
        </div>

        <!-- ===== VIEW: –ü–†–û–•–û–î–ñ–ï–ù–ù–Ø ===== -->
        <div class="view" id="viewTest">
            <div class="test-container" id="testContainer"></div>
        </div>

        <!-- ===== VIEW: –†–ï–ó–£–õ–¨–¢–ê–¢ ===== -->
        <div class="view" id="viewResult">
            <div id="resultContent"></div>
        </div>

        <!-- ===== VIEW: –°–¢–í–û–†–ï–ù–ù–Ø / –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø ===== -->
        <div class="view" id="viewCreate">
            <div class="form-box" id="createForm"></div>
        </div>

        <!-- ===== VIEW: –ü–ï–†–ï–í–Ü–†–ö–ê ===== -->
        <div class="view" id="viewReview">
            <div id="reviewContent"></div>
        </div>

        <!-- ===== VIEW: –ö–ï–†–£–í–ê–ù–ù–Ø ===== -->
        <div class="view" id="viewManage">
            <div id="manageContent"></div>
        </div>

        <!-- ===== VIEW: –ù–ê–°–¢–†–û–ô–ö–ò ===== -->
        <div class="view" id="viewSettings">
            <div id="settingsContent"></div>
        </div>
    </div>

    <!-- ===== –ú–û–î–ê–õ–ö–ê ===== -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal-content" id="modalContent"></div>
    </div>

<script>
/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-1: –°–•–û–í–ò–©–ï (localStorage)
   ================================================================ */
const STORAGE = {
    tests: 'isput_tests',
    results: 'isput_results',
    role: 'isput_role',
    userName: 'isput_userName',
    webhook: 'isput_webhook',
    checkers: 'isput_checkers',
    users: 'isput_users',
    notifs: 'isput_notifs'
};

function getTests() { return JSON.parse(localStorage.getItem(STORAGE.tests) || '[]'); }
function saveTests(t) { localStorage.setItem(STORAGE.tests, JSON.stringify(t)); }
function getResults() { return JSON.parse(localStorage.getItem(STORAGE.results) || '[]'); }
function saveResults(r) { localStorage.setItem(STORAGE.results, JSON.stringify(r)); }
function getRole() { return localStorage.getItem(STORAGE.role) || 'fighter'; }
function setRole(r) { localStorage.setItem(STORAGE.role, r); }
function getUserName() { return localStorage.getItem(STORAGE.userName) || '–ë—ñ—î—Ü—å'; }
function setUserName(n) { localStorage.setItem(STORAGE.userName, n); }
function getWebhook() { return localStorage.getItem(STORAGE.webhook) || ''; }
function setWebhook(w) { localStorage.setItem(STORAGE.webhook, w); }
function getCheckers() { return JSON.parse(localStorage.getItem(STORAGE.checkers) || '[]'); }
function saveCheckers(c) { localStorage.setItem(STORAGE.checkers, JSON.stringify(c)); }
function getUsers() { return JSON.parse(localStorage.getItem(STORAGE.users) || '[]'); }
function saveUsers(u) { localStorage.setItem(STORAGE.users, JSON.stringify(u)); }
function getNotifs() { return JSON.parse(localStorage.getItem(STORAGE.notifs) || '[]'); }
function saveNotifs(n) { localStorage.setItem(STORAGE.notifs, JSON.stringify(n)); }

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —é–∑–µ—Ä—ñ–≤ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
function initDefaultUsers() {
    let users = getUsers();
    if (users.length === 0) {
        users = [
            { name: '–†—É—Å–ª–∞–Ω –ö—É—â–∏—Ä–≥', role: 'admin' },
            { name: '–ù—ñ–∫—ñ—Ç–∞ –õ—ñ–∑–µ–π–Ω–∏–∫', role: 'admin' },
            { name: '–ö—ñ—Ä—ñ–ª –ë–∞—Å–æ–≤', role: 'admin' },
            { name: '–í–∞—Å–∏–ª—å –ì—Ä–∏—â—É–∫', role: 'instructor' },
            { name: '–û–ª–µ–∫—Å—ñ–π –ü–µ—Ç—Ä–µ–Ω–∫–æ', role: 'fighter' },
            { name: '–ê–Ω–¥—Ä—ñ–π –ö–æ–≤–∞–ª–µ–Ω–∫–æ', role: 'fighter' },
            { name: '–î–º–∏—Ç—Ä–æ –®–µ–≤—á–µ–Ω–∫–æ', role: 'fighter' },
            { name: '–Ü–≥–æ—Ä –ú–µ–ª—å–Ω–∏–∫', role: 'instructor' },
        ];
        saveUsers(users);
    }
}

// –î–µ—Ñ–æ–ª—Ç–Ω—ñ —Ç–µ—Å—Ç–∏
function initDefaultTests() {
    if (getTests().length === 0) {
        const defaults = [
            {
                id: 'test_1',
                title: '–°—Ç–∞—Ç—É—Ç –ó–°–£ ‚Äî –ë–∞–∑–æ–≤–∏–π',
                description: '–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–Ω–∞–Ω—å –æ—Å–Ω–æ–≤–Ω–∏—Ö –ø–æ–ª–æ–∂–µ–Ω—å –°—Ç–∞—Ç—É—Ç—É –ó–±—Ä–æ–π–Ω–∏—Ö –°–∏–ª –£–∫—Ä–∞—ó–Ω–∏.',
                emoji: 'üìú',
                category: '–°—Ç–∞—Ç—É—Ç–∏',
                maxScore: 12,
                passScore: 8,
                timerPerQ: 30,
                createdAt: Date.now(),
                questions: [
                    {
                        text: '–©–æ —î –æ—Å–Ω–æ–≤–Ω–∏–º –æ–±–æ–≤\'—è–∑–∫–æ–º –≤—ñ–π—Å—å–∫–æ–≤–æ—Å–ª—É–∂–±–æ–≤—Ü—è?',
                        variants: [
                            { letter:'–ê', text:'–ó–∞—Ö–∏—Å—Ç –í—ñ—Ç—á–∏–∑–Ω–∏', isCorrect:true },
                            { letter:'–ë', text:'–í–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞–∫–∞–∑—ñ–≤', isCorrect:false },
                            { letter:'–í', text:'–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–∞–π–Ω–∞', isCorrect:false },
                            { letter:'–ì', text:'–§—ñ–∑–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞', isCorrect:false },
                        ],
                        hasFreeAnswer: false
                    },
                    {
                        text: '–•—Ç–æ —î –í–µ—Ä—Ö–æ–≤–Ω–∏–º –ì–æ–ª–æ–≤–Ω–æ–∫–æ–º–∞–Ω–¥—É–≤–∞—á–µ–º –ó–°–£?',
                        variants: [
                            { letter:'–ê', text:'–ú—ñ–Ω—ñ—Å—Ç—Ä –æ–±–æ—Ä–æ–Ω–∏', isCorrect:false },
                            { letter:'–ë', text:'–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –£–∫—Ä–∞—ó–Ω–∏', isCorrect:true },
                            { letter:'–í', text:'–ù–∞—á–∞–ª—å–Ω–∏–∫ –ì–µ–Ω—à—Ç–∞–±—É', isCorrect:false },
                            { letter:'–ì', text:'–ì–æ–ª–æ–≤–∞ –í–µ—Ä—Ö–æ–≤–Ω–æ—ó –†–∞–¥–∏', isCorrect:false },
                        ],
                        hasFreeAnswer: false
                    },
                    {
                        text: '–©–æ —Ç–∞–∫–µ –≤—ñ–π—Å—å–∫–æ–≤–∞ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞?',
                        variants: [
                            { letter:'–ê', text:'–°—É–≤–æ—Ä–µ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ä—è–¥–∫—É', isCorrect:true },
                            { letter:'–ë', text:'–§—ñ–∑–∏—á–Ω–∞ –≤–∏—Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å', isCorrect:false },
                            { letter:'–í', text:'–ó–Ω–∞–Ω–Ω—è –∑–±—Ä–æ—ó', isCorrect:false },
                        ],
                        hasFreeAnswer: false
                    },
                    {
                        text: '–ù–∞–∑–≤—ñ—Ç—å –æ—Å–Ω–æ–≤–Ω—ñ –≤–∏–¥–∏ —Å—Ç—Ä–æ–π–æ–≤–∏—Ö –∫–æ–º–∞–Ω–¥.',
                        variants: [],
                        hasFreeAnswer: true
                    }
                ]
            },
            {
                id: 'test_2',
                title: '–¢–∞–∫—Ç–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞',
                description: '–û—Å–Ω–æ–≤–∏ —Ç–∞–∫—Ç–∏—á–Ω–æ—ó –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –±—ñ–π—Ü—è –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É.',
                emoji: 'üéØ',
                category: '–¢–∞–∫—Ç–∏–∫–∞',
                maxScore: 8,
                passScore: 5,
                timerPerQ: 45,
                createdAt: Date.now(),
                questions: [
                    {
                        text: '–©–æ —Ç–∞–∫–µ "–º–µ—Ä—Ç–≤–∞ –∑–æ–Ω–∞"?',
                        variants: [
                            { letter:'–ê', text:'–ó–æ–Ω–∞ –¥–µ –Ω–µ –¥—ñ—Å—Ç–∞—î –≤–æ–≥–æ–Ω—å', isCorrect:true },
                            { letter:'–ë', text:'–ó–æ–Ω–∞ –ø–æ—Ä–∞–∑–∫–∏', isCorrect:false },
                            { letter:'–í', text:'–ó–æ–Ω–∞ –≤—ñ–¥–ø–æ—á–∏–Ω–∫—É', isCorrect:false },
                        ],
                        hasFreeAnswer: false
                    },
                    {
                        text: '–Ø–∫–∞ –¥–∏—Å—Ç–∞–Ω—Ü—ñ—è –≤–≤–∞–∂–∞—î—Ç—å—Å—è –±–ª–∏–∂–Ω—ñ–º –±–æ—î–º?',
                        variants: [
                            { letter:'–ê', text:'–î–æ 100–º', isCorrect:false },
                            { letter:'–ë', text:'–î–æ 50–º', isCorrect:true },
                            { letter:'–í', text:'–î–æ 200–º', isCorrect:false },
                            { letter:'–ì', text:'–î–æ 500–º', isCorrect:false },
                        ],
                        hasFreeAnswer: false
                    }
                ]
            }
        ];
        saveTests(defaults);
    }
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-2: –†–û–õ–Ü, –ù–ê–í–Ü–ì–ê–¶–Ü–Ø
   ================================================================ */
let currentView = 'home';
let currentTestId = null;
let currentQuestionIdx = 0;
let testAnswers = [];
let timerInterval = null;
let editingTestId = null;

function isAdmin() { return getRole() === 'admin'; }
function isChecker() {
    const checkers = getCheckers();
    return checkers.some(c => c.name === getUserName());
}
function canCheck() { return isAdmin() || isChecker(); }

function updateHeader() {
    const role = getRole();
    const name = getUserName();
    document.getElementById('headerUserName').textContent = name;
    const badge = document.getElementById('headerRole');
    if (role === 'admin') {
        badge.textContent = '–ê–î–ú–Ü–ù';
        badge.className = 'role-badge role-admin';
    } else if (role === 'instructor') {
        badge.textContent = '–Ü–ù–°–¢–†–£–ö–¢–û–†';
        badge.className = 'role-badge';
        badge.style.background = 'rgba(251,191,36,0.2)';
        badge.style.color = '#fbbf24';
        badge.style.border = '1px solid #fbbf24';
    } else {
        badge.textContent = '–ë–Ü–Ñ–¶–¨';
        badge.className = 'role-badge role-user';
    }

    document.getElementById('navCreate').style.display = isAdmin() ? '' : 'none';
    document.getElementById('navReview').style.display = canCheck() ? '' : 'none';
    document.getElementById('navManage').style.display = isAdmin() ? '' : 'none';
    document.getElementById('navSettings').style.display = isAdmin() ? '' : 'none';

    // Review badge
    const pending = getResults().filter(r => r.status === 'pending');
    const rb = document.getElementById('reviewBadge');
    if (pending.length > 0 && canCheck()) { rb.style.display = ''; rb.textContent = ' ' + pending.length; }
    else { rb.style.display = 'none'; }
}

function navigate(view) {
    if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
    currentView = view;
    editingTestId = null;
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('view' + view.charAt(0).toUpperCase() + view.slice(1)).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    const navMap = { home:0, create:1, review:2, manage:3, settings:4 };
    const btns = document.querySelectorAll('.header-right .nav-btn');
    if (btns[navMap[view]]) btns[navMap[view]].classList.add('active');

    if (view === 'home') renderHome();
    if (view === 'create') renderCreateForm();
    if (view === 'review') renderReview();
    if (view === 'manage') renderManage();
    if (view === 'settings') renderSettings();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-3: –ù–û–¢–ò–§–Ü–ö–ê–¶–Ü–á
   ================================================================ */
function addNotif(text) {
    const notifs = getNotifs();
    notifs.unshift({ text, time: Date.now(), read: false, id: 'n_' + Date.now() + Math.random() });
    if (notifs.length > 50) notifs.length = 50;
    saveNotifs(notifs);
    renderNotifs();
}

function renderNotifs() {
    const notifs = getNotifs();
    const list = document.getElementById('notifList');
    const badge = document.getElementById('notifBadge');
    const unread = notifs.filter(n => !n.read).length;
    if (unread > 0) { badge.style.display = ''; badge.textContent = unread; }
    else { badge.style.display = 'none'; }
    if (notifs.length === 0) {
        list.innerHTML = '<div class="notif-item" style="text-align:center;color:var(--text-gray);">–ù–µ–º–∞—î —Å–ø–æ–≤—ñ—â–µ–Ω—å</div>';
        return;
    }
    list.innerHTML = notifs.slice(0, 20).map(n => {
        const ago = timeAgo(n.time);
        return `<div class="notif-item ${n.read ? 'read' : ''}" onclick="markNotifRead('${n.id}')">
            <div style="font-size:12px;font-weight:600;">üì¢ ${n.text}</div>
            <div class="notif-time">${ago}</div>
        </div>`;
    }).join('');
}

function markNotifRead(id) {
    const notifs = getNotifs();
    const n = notifs.find(x => x.id === id);
    if (n) n.read = true;
    saveNotifs(notifs);
    renderNotifs();
}

function clearNotifs() {
    saveNotifs([]);
    renderNotifs();
}

function toggleNotifPanel(e) {
    e.stopPropagation();
    document.getElementById('notifDropdown').classList.toggle('open');
}

function timeAgo(ts) {
    const diff = Date.now() - ts;
    const mins = Math.floor(diff / 60000);
    if (mins < 1) return '—â–æ–π–Ω–æ';
    if (mins < 60) return mins + ' —Ö–≤. —Ç–æ–º—É';
    const hrs = Math.floor(mins / 60);
    if (hrs < 24) return hrs + ' –≥–æ–¥. —Ç–æ–º—É';
    return Math.floor(hrs / 24) + ' –¥–Ω. —Ç–æ–º—É';
}

document.addEventListener('click', (e) => {
    if (!e.target.closest('.notif-wrapper') && !e.target.closest('.notif-dropdown')) {
        document.getElementById('notifDropdown').classList.remove('open');
    }
});

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-4: DISCORD WEBHOOK
   ================================================================ */
async function sendWebhook(data) {
    const url = getWebhook();
    if (!url) return;
    try {
        const embed = {
            title: 'üìã ' + (data.title || '–ù–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ—Å–ø–∏—Ç—É'),
            color: data.passed ? 0x00ff44 : 0xef4444,
            fields: [
                { name: 'üë§ –ë–æ—î—Ü—å', value: data.userName || '---', inline: true },
                { name: 'üìù –¢–µ—Å—Ç', value: data.testName || '---', inline: true },
                { name: 'üìä –ë–∞–ª–∏', value: `${data.score} / ${data.maxScore}`, inline: true },
                { name: 'üéØ –ü—Ä–æ—Ö—ñ–¥–Ω–∏–π –±–∞–ª', value: String(data.passScore), inline: true },
                { name: 'üìÖ –î–∞—Ç–∞', value: new Date().toLocaleString('uk-UA'), inline: true },
                { name: '‚úÖ –°—Ç–∞—Ç—É—Å', value: data.passed ? '‚úÖ –°–ö–õ–ê–í' : '‚ùå –ù–ï –°–ö–õ–ê–í', inline: true },
            ],
            footer: { text: data.reviewerNote || '' },
            timestamp: new Date().toISOString()
        };
        if (data.reviewer) {
            embed.fields.push({ name: 'üîç –ü–µ—Ä–µ–≤—ñ—Ä–∏–≤', value: data.reviewer, inline: true });
        }
        await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ embeds: [embed] })
        });
    } catch (e) { console.error('Webhook error:', e); }
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-5: –†–ï–ù–î–ï–† –ì–û–õ–û–í–ù–û–á
   ================================================================ */
function renderHome() {
    const tests = getTests();
    const results = getResults();
    const myResults = results.filter(r => r.userName === getUserName());

    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    const totalTests = tests.length;
    const totalPassed = myResults.filter(r => r.status === 'approved' || (r.status === 'auto' && r.passed)).length;
    const totalFailed = myResults.filter(r => r.status === 'rejected' || (r.status === 'auto' && !r.passed)).length;
    const avgScore = myResults.length > 0 ? Math.round(myResults.reduce((a, r) => a + (r.score || 0), 0) / myResults.length) : 0;

    document.getElementById('statsRow').innerHTML = `
        <div class="stat-card fade-in"><div class="stat-num">${totalTests}</div><div class="stat-label">–¢–µ—Å—Ç—ñ–≤</div></div>
        <div class="stat-card fade-in" style="animation-delay:0.1s"><div class="stat-num" style="color:var(--primary);">${totalPassed}</div><div class="stat-label">–°–∫–ª–∞–≤</div></div>
        <div class="stat-card fade-in" style="animation-delay:0.2s"><div class="stat-num" style="color:var(--danger);">${totalFailed}</div><div class="stat-label">–ù–µ —Å–∫–ª–∞–≤</div></div>
        <div class="stat-card fade-in" style="animation-delay:0.3s"><div class="stat-num" style="color:var(--warning);">${avgScore}</div><div class="stat-label">–°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª</div></div>
    `;

    // –¢–µ—Å—Ç–∏
    const grid = document.getElementById('testsGrid');
    if (tests.length === 0) {
        grid.innerHTML = '<div style="color:var(--text-gray);text-align:center;padding:40px;font-size:14px;">–¢–µ—Å—Ç—ñ–≤ –ø–æ–∫–∏ –Ω–µ–º–∞—î</div>';
    } else {
        grid.innerHTML = tests.map(t => {
            const qCount = t.questions ? t.questions.length : 0;
            return `<div class="test-card fade-in" onclick="showIntro('${t.id}')">
                <span class="emoji">${t.emoji || 'üìù'}</span>
                <div class="title">${t.title}</div>
                <div class="desc">${t.description || ''}</div>
                <div class="meta">
                    <span class="tag tag-green">${qCount} –ø–∏—Ç–∞–Ω—å</span>
                    <span class="tag tag-yellow">${t.maxScore || 0} –±–∞–ª—ñ–≤</span>
                    <span class="tag tag-blue">${t.category || '–ó–∞–≥–∞–ª—å–Ω–µ'}</span>
                    <span class="tag tag-green">–ü—Ä–æ—Ö—ñ–¥: ${t.passScore || 0} –±.</span>
                </div>
            </div>`;
        }).join('');
    }

    // –ú–æ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
    const myRes = document.getElementById('myResults');
    if (myResults.length === 0) {
        myRes.innerHTML = '<div style="color:var(--text-gray);text-align:center;padding:20px;font-size:13px;">–í–∏ —â–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ç–µ—Å—Ç–∏</div>';
    } else {
        myRes.innerHTML = myResults.sort((a, b) => b.date - a.date).map(r => {
            let statusClass = '', statusText = '';
            if (r.status === 'pending') { statusClass = 'ri-pending'; statusText = '–ù–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ'; }
            else if (r.status === 'approved') { statusClass = 'ri-approved'; statusText = '‚úÖ –°—Ö–≤–∞–ª–µ–Ω–æ'; }
            else if (r.status === 'rejected') { statusClass = 'ri-rejected'; statusText = '‚ùå –í—ñ–¥—Ö–∏–ª–µ–Ω–æ'; }
            else if (r.status === 'auto' && r.passed) { statusClass = 'ri-passed'; statusText = '‚úÖ –°–∫–ª–∞–≤'; }
            else if (r.status === 'auto' && !r.passed) { statusClass = 'ri-failed'; statusText = '‚ùå –ù–µ —Å–∫–ª–∞–≤'; }
            else { statusClass = r.passed ? 'ri-passed' : 'ri-failed'; statusText = r.passed ? '‚úÖ –°–∫–ª–∞–≤' : '‚ùå –ù–µ —Å–∫–ª–∞–≤'; }
            const reviewer = r.reviewer ? `<span class="reviewer-name">–ü–µ—Ä–µ–≤—ñ—Ä–∏–≤: ${r.reviewer}</span>` : '';
            return `<div class="result-item">
                <div><span class="ri-name">${r.testName || '---'}</span> ${reviewer}</div>
                <div class="ri-date">${new Date(r.date).toLocaleString('uk-UA')}</div>
                <span class="ri-score">${r.score}/${r.maxScore}</span>
                <span class="ri-status ${statusClass}">${statusText}</span>
            </div>`;
        }).join('');
    }
    updateHeader();
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-6: –Ü–ù–¢–†–û –¢–ï–°–¢–£
   ================================================================ */
function showIntro(testId) {
    const test = getTests().find(t => t.id === testId);
    if (!test) return;
    currentTestId = testId;
    const qCount = test.questions ? test.questions.length : 0;
    const hasFree = test.questions && test.questions.some(q => q.hasFreeAnswer);

    document.getElementById('introContent').innerHTML = `
        <span class="emoji">${test.emoji || 'üìù'}</span>
        <div class="title">${test.title}</div>
        <div class="desc">${test.description || ''}</div>
        <div class="intro-info">
            <span class="tag tag-green">${qCount} –ø–∏—Ç–∞–Ω—å</span>
            <span class="tag tag-yellow">–ú–∞–∫—Å: ${test.maxScore} –±–∞–ª—ñ–≤</span>
            <span class="tag tag-blue">–ü—Ä–æ—Ö—ñ–¥: ${test.passScore} –±–∞–ª—ñ–≤</span>
            <span class="tag tag-green">‚è± ${test.timerPerQ || 30}—Å –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è</span>
        </div>
        ${hasFree ? '<p style="color:var(--warning);font-size:12px;margin-bottom:15px;">‚ö†Ô∏è –¢–µ—Å—Ç –º—ñ—Å—Ç–∏—Ç—å –≤—ñ–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî –ø–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏</p>' : ''}
        <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
            <button class="btn-primary" onclick="startTest('${testId}')">üöÄ –†–û–ó–ü–û–ß–ê–¢–ò</button>
            <button class="btn-secondary" onclick="navigate('home')">‚Üê –ù–ê–ó–ê–î</button>
        </div>
    `;
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('viewIntro').classList.add('active');
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-7: –ü–†–û–•–û–î–ñ–ï–ù–ù–Ø –¢–ï–°–¢–£
   ================================================================ */
let currentTimerValue = 0;

function startTest(testId) {
    const test = getTests().find(t => t.id === testId);
    if (!test || !test.questions || test.questions.length === 0) return;
    currentTestId = testId;
    currentQuestionIdx = 0;
    testAnswers = test.questions.map(() => ({ selected: null, freeText: '', confirmed: false }));
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('viewTest').classList.add('active');
    renderQuestion();
}

function renderQuestion() {
    const test = getTests().find(t => t.id === currentTestId);
    if (!test) return;
    const q = test.questions[currentQuestionIdx];
    const total = test.questions.length;
    const progress = ((currentQuestionIdx) / total) * 100;
    const answer = testAnswers[currentQuestionIdx];
    const timerSec = test.timerPerQ || 30;

    let variantsHTML = '';
    if (q.variants && q.variants.length > 0) {
        variantsHTML = '<div class="answers-list">' + q.variants.map((v, i) => {
            const sel = answer.selected === i ? 'selected' : '';
            const disabled = answer.confirmed ? 'style="pointer-events:none;"' : '';
            let extra = '';
            if (answer.confirmed) {
                if (v.isCorrect) extra = 'correct';
                else if (answer.selected === i && !v.isCorrect) extra = 'wrong';
            }
            return `<button class="answer-btn ${sel} ${extra}" ${disabled} onclick="selectAnswer(${i})">
                <span class="answer-letter">${v.letter || String.fromCharCode(65 + i)}</span>
                <span>${v.text}</span>
            </button>`;
        }).join('') + '</div>';
    }

    let freeHTML = '';
    if (q.hasFreeAnswer) {
        freeHTML = `<div style="margin-top:15px;">
            <div class="free-label">‚úç –í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:</div>
            <textarea class="free-answer-area" id="freeAnswerInput" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –≤–∞—à—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å..." ${answer.confirmed ? 'disabled' : ''}>${answer.freeText || ''}</textarea>
        </div>`;
    }

    const isLast = currentQuestionIdx === total - 1;
    const canConfirm = !answer.confirmed;
    const hasSelection = answer.selected !== null || (q.hasFreeAnswer);

    document.getElementById('testContainer').innerHTML = `
        <div class="fade-in">
            <div class="progress-bar-wrap"><div class="progress-bar-fill" style="width:${progress}%"></div></div>
            <div class="question-header">
                <span class="q-counter">–ü–∏—Ç–∞–Ω–Ω—è ${currentQuestionIdx + 1} / ${total}</span>
                <span class="timer" id="timerDisplay">‚è± ${timerSec}</span>
            </div>
            <div class="question-text">${q.text}</div>
            ${variantsHTML}
            ${freeHTML}
            <div style="display:flex;gap:10px;margin-top:15px;">
                ${canConfirm ? `<button class="btn-confirm" id="btnConfirm" onclick="confirmAnswer()">–ü–Ü–î–¢–í–ï–†–î–ò–¢–ò</button>` :
                    (isLast ? `<button class="btn-confirm" onclick="finishTest()">üèÅ –ó–ê–í–ï–†–®–ò–¢–ò –¢–ï–°–¢</button>` :
                    `<button class="btn-confirm" onclick="nextQuestion()">–î–ê–õ–Ü ‚Üí</button>`)}
            </div>
        </div>
    `;

    // –¢–∞–π–º–µ—Ä
    if (!answer.confirmed) {
        startTimer(timerSec);
    }
}

function startTimer(seconds) {
    if (timerInterval) clearInterval(timerInterval);
    currentTimerValue = seconds;
    const display = document.getElementById('timerDisplay');
    timerInterval = setInterval(() => {
        currentTimerValue--;
        if (display) {
            display.textContent = '‚è± ' + currentTimerValue;
            if (currentTimerValue <= 10) display.classList.add('danger');
        }
        if (currentTimerValue <= 0) {
            clearInterval(timerInterval);
            confirmAnswer(true);
        }
    }, 1000);
}

function selectAnswer(idx) {
    const answer = testAnswers[currentQuestionIdx];
    if (answer.confirmed) return;
    answer.selected = idx;
    renderQuestion();
    // –ù–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î–º–æ —Ç–∞–π–º–µ—Ä –ø—Ä–∏ –≤–∏–±–æ—Ä—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
    if (timerInterval) clearInterval(timerInterval);
    startTimer(currentTimerValue);
}

function confirmAnswer(timeout) {
    if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
    const answer = testAnswers[currentQuestionIdx];
    const test = getTests().find(t => t.id === currentTestId);
    const q = test.questions[currentQuestionIdx];

    // –ó–±–µ—Ä–µ–≥—Ç–∏ –≤—ñ–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
    if (q.hasFreeAnswer) {
        const ta = document.getElementById('freeAnswerInput');
        if (ta) answer.freeText = ta.value;
    }

    answer.confirmed = true;
    if (timeout && answer.selected === null && !q.hasFreeAnswer) {
        answer.timedOut = true;
    }
    renderQuestion();
}

function nextQuestion() {
    currentQuestionIdx++;
    renderQuestion();
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-8: –ó–ê–í–ï–†–®–ï–ù–ù–Ø –¢–ï–°–¢–£
   ================================================================ */
function finishTest() {
    if (timerInterval) { clearInterval(timerInterval); timerInterval = null; }
    const test = getTests().find(t => t.id === currentTestId);
    if (!test) return;

    const total = test.questions.length;
    const pointsPerQ = total > 0 ? test.maxScore / total : 0;
    let score = 0;
    let hasFreeAnswers = false;
    const details = [];

    test.questions.forEach((q, i) => {
        const ans = testAnswers[i];
        let correct = false;
        let userAnswer = '(–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–≤)';
        let correctAnswer = '';
        let isPending = false;

        if (q.variants && q.variants.length > 0 && ans.selected !== null) {
            const chosen = q.variants[ans.selected];
            userAnswer = (chosen.letter || '') + ': ' + chosen.text;
            const correctVar = q.variants.find(v => v.isCorrect);
            correctAnswer = correctVar ? (correctVar.letter + ': ' + correctVar.text) : '';
            if (chosen.isCorrect) {
                correct = true;
                score += pointsPerQ;
            }
        }

        if (q.hasFreeAnswer) {
            hasFreeAnswers = true;
            isPending = true;
            if (ans.freeText) {
                userAnswer = (userAnswer !== '(–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–≤)' ? userAnswer + '\n‚úç ' : '‚úç ') + ans.freeText;
            }
        } else if (q.variants && q.variants.length === 0) {
            // –Ø–∫—â–æ –Ω–µ–º–∞—î –Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –Ω—ñ –≤—ñ–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
        }

        details.push({ question: q.text, userAnswer, correctAnswer, correct, isPending, hasFree: q.hasFreeAnswer, freeText: ans.freeText || '' });
    });

    score = Math.round(score * 10) / 10;
    const passed = score >= test.passScore;
    const needsReview = hasFreeAnswers;

    const result = {
        id: 'res_' + Date.now(),
        testId: test.id,
        testName: test.title,
        userName: getUserName(),
        score: score,
        maxScore: test.maxScore,
        passScore: test.passScore,
        passed: passed,
        status: needsReview ? 'pending' : 'auto',
        details: details,
        date: Date.now(),
        reviewer: needsReview ? null : 'SYSTEM'
    };

    const results = getResults();
    results.push(result);
    saveResults(results);

    // Webhook
    if (!needsReview) {
        sendWebhook({
            title: '–†–µ–∑—É–ª—å—Ç–∞—Ç —ñ—Å–ø–∏—Ç—É',
            userName: getUserName(),
            testName: test.title,
            score: score,
            maxScore: test.maxScore,
            passScore: test.passScore,
            passed: passed,
            reviewer: 'SYSTEM',
            reviewerNote: '–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ | –ü–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏–π: SYSTEM'
        });
    }

    // –ù–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä—é–≤–∞—á—ñ–≤
    if (needsReview) {
        addNotif(`${getUserName()} –∑–¥–∞–≤ —Ç–µ—Å—Ç "${test.title}" ‚Äî –ø–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏`);
    }

    showResult(result);
    updateHeader();
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-9: –†–ï–ù–î–ï–† –†–ï–ó–£–õ–¨–¢–ê–¢–£
   ================================================================ */
function showResult(result) {
    const cls = result.passed ? 'passed' : 'failed';
    const statusText = result.status === 'pending' ? '‚è≥ –ù–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ' : (result.passed ? '‚úÖ –°–ö–õ–ê–í' : '‚ùå –ù–ï –°–ö–õ–ê–í');
    const statusColor = result.status === 'pending' ? 'var(--warning)' : (result.passed ? 'var(--primary)' : 'var(--danger)');

    let detailsHTML = result.details.map(d => {
        let qClass = d.isPending ? 'q-pending' : (d.correct ? 'q-correct' : 'q-wrong');
        let icon = d.isPending ? '‚è≥' : (d.correct ? '‚úÖ' : '‚ùå');
        return `<div class="result-q-item ${qClass}">
            <div class="result-q-text">${icon} ${d.question}</div>
            <div class="result-q-answer">–í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${d.userAnswer}</div>
            ${d.correctAnswer && !d.isPending ? `<div style="font-size:11px;color:var(--primary);margin-top:3px;">–ü—Ä–∞–≤–∏–ª—å–Ω–∞: ${d.correctAnswer}</div>` : ''}
        </div>`;
    }).join('');

    document.getElementById('resultContent').innerHTML = `
        <div class="result-box ${cls} fade-in">
            <div style="font-size:50px;">${result.passed ? 'üèÜ' : 'üíî'}</div>
            <div class="result-status" style="color:${statusColor};">${statusText}</div>
            <div class="result-score">${result.score} / ${result.maxScore}</div>
            <div class="result-sub">–ü—Ä–æ—Ö—ñ–¥–Ω–∏–π –±–∞–ª: ${result.passScore} | ${result.status === 'pending' ? '–û—á—ñ–∫—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—ñ–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π' : ''}</div>
            ${result.reviewer ? `<div style="font-size:12px;color:var(--blue);margin-bottom:15px;">–ü–µ—Ä–µ–≤—ñ—Ä–∏–≤: ${result.reviewer}</div>` : ''}
            <div class="result-details">${detailsHTML}</div>
            <div class="result-btns">
                <button class="btn-primary" onclick="showIntro('${result.testId}')">üîÑ –ü–†–û–ô–¢–ò –ó–ù–û–í–£</button>
                <button class="btn-secondary" onclick="navigate('home')">üè† –ù–ê –ì–û–õ–û–í–ù–£</button>
            </div>
        </div>
    `;

    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('viewResult').classList.add('active');
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-10: –°–¢–í–û–†–ï–ù–ù–Ø / –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –¢–ï–°–¢–£
   ================================================================ */
let createQuestions = [];

function renderCreateForm(existingTest) {
    editingTestId = existingTest ? existingTest.id : null;
    const t = existingTest || { title: '', description: '', emoji: 'üìù', category: '', maxScore: 12, passScore: 8, timerPerQ: 30, questions: [] };
    createQuestions = JSON.parse(JSON.stringify(t.questions || []));
    if (createQuestions.length === 0) {
        createQuestions.push({ text: '', variants: [{ letter: '–ê', text: '', isCorrect: true }, { letter: '–ë', text: '', isCorrect: false }], hasFreeAnswer: false });
    }

    const isEdit = !!editingTestId;

    document.getElementById('createForm').innerHTML = `
        <div class="section-title">${isEdit ? '‚úèÔ∏è –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –¢–ï–°–¢–£' : '‚ûï –°–¢–í–û–†–ï–ù–ù–Ø –ù–û–í–û–ì–û –¢–ï–°–¢–£'}</div>
        <div class="section-box">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞ —Ç–µ—Å—Ç—É</label>
                    <input class="form-input" id="cTitle" value="${t.title}" placeholder="–ù–∞–∑–≤–∞...">
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                    <input class="form-input" id="cCategory" value="${t.category || ''}" placeholder="–¢–∞–∫—Ç–∏–∫–∞, –°—Ç–∞—Ç—É—Ç–∏...">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">–û–ø–∏—Å</label>
                <textarea class="form-input form-textarea" id="cDesc" placeholder="–û–ø–∏—Å —Ç–µ—Å—Ç—É...">${t.description || ''}</textarea>
            </div>
            <div class="form-row-3">
                <div class="form-group">
                    <label class="form-label">–ï–º–æ–¥–∑—ñ</label>
                    <input class="form-input" id="cEmoji" value="${t.emoji || 'üìù'}" maxlength="4">
                </div>
                <div class="form-group">
                    <label class="form-label">–ú–∞–∫—Å. –±–∞–ª—ñ–≤</label>
                    <input class="form-input" id="cMaxScore" type="number" value="${t.maxScore || 12}" min="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü—Ä–æ—Ö—ñ–¥–Ω–∏–π –±–∞–ª</label>
                    <input class="form-input" id="cPassScore" type="number" value="${t.passScore || 8}" min="1">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">–¢–∞–π–º–µ—Ä –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è (—Å–µ–∫—É–Ω–¥–∏)</label>
                <input class="form-input" id="cTimer" type="number" value="${t.timerPerQ || 30}" min="10" max="300">
            </div>
            <div style="margin-top:10px;">
                <p style="font-size:11px;color:var(--text-gray);">‚ö° –ê–≤—Ç–æ-—Ä–æ–∑–ø–æ–¥—ñ–ª: –∫–æ–∂–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è = <strong id="autoPointsDisplay">---</strong> –±–∞–ª—ñ–≤</p>
            </div>
        </div>
        <div class="section-title" style="margin-top:20px;">üìù –ü–ò–¢–ê–ù–ù–Ø</div>
        <div id="questionsContainer"></div>
        <button class="btn-add-question" onclick="addQuestion()">+ –î–û–î–ê–¢–ò –ü–ò–¢–ê–ù–ù–Ø</button>
        <div style="display:flex;gap:10px;justify-content:center;margin-top:20px;">
            <button class="btn-primary" onclick="saveTest()">${isEdit ? 'üíæ –ó–ë–ï–†–ï–ì–¢–ò –ó–ú–Ü–ù–ò' : 'üíæ –ó–ë–ï–†–ï–ì–¢–ò –¢–ï–°–¢'}</button>
            <button class="btn-secondary" onclick="navigate('home')">–°–ö–ê–°–£–í–ê–¢–ò</button>
        </div>
    `;

    renderQuestionsEditor();
    updateAutoPoints();

    // –°–ª—É—Ö–∞—á—ñ –¥–ª—è –∞–≤—Ç–æ-—Ä–æ–∑–ø–æ–¥—ñ–ª—É
    document.getElementById('cMaxScore').addEventListener('input', updateAutoPoints);
}

function updateAutoPoints() {
    const maxScore = parseFloat(document.getElementById('cMaxScore').value) || 0;
    const qCount = createQuestions.length;
    const perQ = qCount > 0 ? Math.round((maxScore / qCount) * 100) / 100 : 0;
    const el = document.getElementById('autoPointsDisplay');
    if (el) el.textContent = perQ + ' –±.';
}

function renderQuestionsEditor() {
    const container = document.getElementById('questionsContainer');
    if (!container) return;
    const letters = ['–ê', '–ë', '–í', '–ì', '–î', '–ï', '–Ñ', '–ñ', '–ó', '–ò', '–Ü'];

    container.innerHTML = createQuestions.map((q, qi) => {
        let variantsHTML = (q.variants || []).map((v, vi) => {
            return `<div class="variant-row">
                <input type="radio" name="correct_${qi}" class="radio-correct" ${v.isCorrect ? 'checked' : ''} onchange="setCorrectVariant(${qi}, ${vi})">
                <input type="text" value="${v.text}" placeholder="–í–∞—Ä—ñ–∞–Ω—Ç ${v.letter || letters[vi] || ''}" onchange="updateVariantText(${qi}, ${vi}, this.value)">
                <button class="btn-remove-variant" onclick="removeVariant(${qi}, ${vi})">√ó</button>
            </div>`;
        }).join('');

        return `<div class="question-block fade-in">
            <button class="btn-remove-q" onclick="removeQuestion(${qi})">√ó</button>
            <div class="q-num">–ü–∏—Ç–∞–Ω–Ω—è #${qi + 1}</div>
            <div class="form-group">
                <input class="form-input" value="${q.text}" placeholder="–¢–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è..." onchange="updateQuestionText(${qi}, this.value)">
            </div>
            <div class="form-label" style="margin-bottom:8px;">–í–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–æ–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É ‚óè)</div>
            <div id="variants_${qi}">${variantsHTML}</div>
            <div style="display:flex;flex-wrap:wrap;gap:5px;margin-top:8px;">
                <button class="btn-add-small" onclick="addVariant(${qi})">+ –î–æ–¥–∞—Ç–∏ –≤–∞—Ä—ñ–∞–Ω—Ç</button>
            </div>
            <div class="toggle-row">
                <button class="toggle-switch ${q.hasFreeAnswer ? 'on' : ''}" onclick="toggleFreeAnswer(${qi}, this)"></button>
                <span class="toggle-label">–î–æ–∑–≤–æ–ª–∏—Ç–∏ –≤—ñ–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</span>
            </div>
        </div>`;
    }).join('');
    updateAutoPoints();
}

function updateQuestionText(qi, val) { createQuestions[qi].text = val; }
function updateVariantText(qi, vi, val) { createQuestions[qi].variants[vi].text = val; }
function setCorrectVariant(qi, vi) {
    createQuestions[qi].variants.forEach((v, i) => v.isCorrect = (i === vi));
}
function removeVariant(qi, vi) {
    createQuestions[qi].variants.splice(vi, 1);
    // –ü–µ—Ä–µ—ñ–º–µ–Ω—É–≤–∞—Ç–∏ –ª—ñ—Ç–µ—Ä–∏
    const letters = ['–ê', '–ë', '–í', '–ì', '–î', '–ï', '–Ñ', '–ñ'];
    createQuestions[qi].variants.forEach((v, i) => v.letter = letters[i] || String.fromCharCode(65 + i));
    // –Ø–∫—â–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–ª–∞ –≤–∏–¥–∞–ª–µ–Ω–∞
    if (!createQuestions[qi].variants.some(v => v.isCorrect) && createQuestions[qi].variants.length > 0) {
        createQuestions[qi].variants[0].isCorrect = true;
    }
    renderQuestionsEditor();
}
function addVariant(qi) {
    const letters = ['–ê', '–ë', '–í', '–ì', '–î', '–ï', '–Ñ', '–ñ'];
    const idx = createQuestions[qi].variants.length;
    createQuestions[qi].variants.push({ letter: letters[idx] || '?', text: '', isCorrect: false });
    renderQuestionsEditor();
}
function toggleFreeAnswer(qi, btn) {
    createQuestions[qi].hasFreeAnswer = !createQuestions[qi].hasFreeAnswer;
    btn.classList.toggle('on');
}
function addQuestion() {
    createQuestions.push({ text: '', variants: [{ letter: '–ê', text: '', isCorrect: true }, { letter: '–ë', text: '', isCorrect: false }], hasFreeAnswer: false });
    renderQuestionsEditor();
}
function removeQuestion(qi) {
    if (createQuestions.length <= 1) return;
    createQuestions.splice(qi, 1);
    renderQuestionsEditor();
}

function saveTest() {
    const title = document.getElementById('cTitle').value.trim();
    const desc = document.getElementById('cDesc').value.trim();
    const emoji = document.getElementById('cEmoji').value.trim() || 'üìù';
    const category = document.getElementById('cCategory').value.trim();
    const maxScore = parseFloat(document.getElementById('cMaxScore').value) || 12;
    const passScore = parseFloat(document.getElementById('cPassScore').value) || 8;
    const timer = parseInt(document.getElementById('cTimer').value) || 30;

    if (!title) { alert('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–µ—Å—Ç—É!'); return; }
    if (createQuestions.some(q => !q.text.trim())) { alert('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ç–µ–∫—Å—Ç —É—Å—ñ—Ö –ø–∏—Ç–∞–Ω—å!'); return; }
    if (passScore > maxScore) { alert('–ü—Ä–æ—Ö—ñ–¥–Ω–∏–π –±–∞–ª –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –±—ñ–ª—å—à–∏–º –∑–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π!'); return; }

    const tests = getTests();

    if (editingTestId) {
        // –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
        const idx = tests.findIndex(t => t.id === editingTestId);
        if (idx !== -1) {
            tests[idx] = { ...tests[idx], title, description: desc, emoji, category, maxScore, passScore, timerPerQ: timer, questions: createQuestions };
        }
    } else {
        // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è
        const newTest = {
            id: 'test_' + Date.now(),
            title, description: desc, emoji, category, maxScore, passScore,
            timerPerQ: timer, createdAt: Date.now(), questions: createQuestions
        };
        tests.push(newTest);
    }

    saveTests(tests);
    addNotif(editingTestId ? `–¢–µ—Å—Ç "${title}" –æ–Ω–æ–≤–ª–µ–Ω–æ` : `–ù–æ–≤–∏–π —Ç–µ—Å—Ç: "${title}"`);

    // Webhook –ø—Ä–æ –Ω–æ–≤–∏–π —Ç–µ—Å—Ç
    if (!editingTestId) {
        sendWebhook({
            title: 'üìö –ù–æ–≤–∏–π —Ç–µ—Å—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ',
            userName: getUserName(),
            testName: title,
            score: '-',
            maxScore: maxScore,
            passScore: passScore,
            passed: true,
            reviewer: getUserName(),
            reviewerNote: `–°—Ç–≤–æ—Ä–∏–≤: ${getUserName()}`
        });
    }

    editingTestId = null;
    navigate('home');
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-11: –ü–ï–†–ï–í–Ü–†–ö–ê (REVIEW)
   ================================================================ */
function renderReview() {
    const results = getResults();
    const pending = results.filter(r => r.status === 'pending');

    let html = '<div class="section-title">üìã –ü–ï–†–ï–í–Ü–†–ö–ê –í–Ü–î–ü–û–í–Ü–î–ï–ô</div>';

    if (pending.length === 0) {
        html += '<div class="section-box" style="text-align:center;color:var(--text-gray);padding:40px;">–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ</div>';
    } else {
        html += pending.map(r => {
            const freeDetails = r.details.filter(d => d.hasFree || d.isPending);
            let questionsHTML = r.details.map((d, i) => {
                let cls = d.isPending ? '' : (d.correct ? 'style="border-left:3px solid var(--primary);"' : 'style="border-left:3px solid var(--danger);"');
                return `<div class="review-q" ${cls}>
                    <div class="q-text">${i + 1}. ${d.question}</div>
                    <div class="q-answer">–í—ñ–¥–ø–æ–≤—ñ–¥—å: ${d.userAnswer}</div>
                    ${d.correctAnswer ? `<div class="q-correct-ans">–ü—Ä–∞–≤–∏–ª—å–Ω–∞: ${d.correctAnswer}</div>` : ''}
                    ${d.hasFree ? '<span class="tag tag-yellow" style="margin-top:5px;display:inline-block;">–í—ñ–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</span>' : ''}
                </div>`;
            }).join('');

            return `<div class="review-card fade-in">
                <div class="review-header">
                    <div>
                        <strong style="font-size:15px;">${r.userName}</strong>
                        <span style="color:var(--text-gray);font-size:12px;margin-left:10px;">${r.testName}</span>
                    </div>
                    <div>
                        <span class="tag tag-yellow">${r.score}/${r.maxScore} –±–∞–ª—ñ–≤ (–∞–≤—Ç–æ)</span>
                        <span style="font-size:11px;color:var(--text-gray);margin-left:10px;">${new Date(r.date).toLocaleString('uk-UA')}</span>
                    </div>
                </div>
                ${questionsHTML}
                <div style="margin-top:15px;">
                    <div class="form-group">
                        <label class="form-label">–î–æ–¥–∞—Ç–∏ / –∑–º—ñ–Ω–∏—Ç–∏ –±–∞–ª–∏ (–ø–æ—Ç–æ—á–Ω—ñ: ${r.score})</label>
                        <input class="form-input" type="number" id="reviewScore_${r.id}" value="${r.score}" min="0" max="${r.maxScore}" step="0.1">
                    </div>
                </div>
                <div class="review-btns">
                    <button class="btn-approve" onclick="approveResult('${r.id}')">‚úÖ –°–•–í–ê–õ–ò–¢–ò</button>
                    <button class="btn-reject" onclick="rejectResult('${r.id}')">‚ùå –í–Ü–î–•–ò–õ–ò–¢–ò</button>
                </div>
            </div>`;
        }).join('');
    }

    document.getElementById('reviewContent').innerHTML = html;
}

function approveResult(resId) {
    const results = getResults();
    const r = results.find(x => x.id === resId);
    if (!r) return;
    const scoreInput = document.getElementById('reviewScore_' + resId);
    if (scoreInput) r.score = parseFloat(scoreInput.value) || r.score;
    r.passed = r.score >= r.passScore;
    r.status = 'approved';
    r.reviewer = getUserName();
    saveResults(results);

    sendWebhook({
        title: '‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ö–≤–∞–ª–µ–Ω–æ',
        userName: r.userName,
        testName: r.testName,
        score: r.score,
        maxScore: r.maxScore,
        passScore: r.passScore,
        passed: r.passed,
        reviewer: getUserName(),
        reviewerNote: `–ü–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏–π: ${getUserName()} | –°—Ç–∞—Ç—É—Å: –°–•–í–ê–õ–ï–ù–û`
    });

    addNotif(`‚úÖ –¢–µ—Å—Ç "${r.testName}" –±—ñ–π—Ü—è ${r.userName} —Å—Ö–≤–∞–ª–µ–Ω–æ (${getUserName()})`);
    renderReview();
    updateHeader();
}

function rejectResult(resId) {
    const results = getResults();
    const r = results.find(x => x.id === resId);
    if (!r) return;
    const scoreInput = document.getElementById('reviewScore_' + resId);
    if (scoreInput) r.score = parseFloat(scoreInput.value) || r.score;
    r.passed = false;
    r.status = 'rejected';
    r.reviewer = getUserName();
    saveResults(results);

    sendWebhook({
        title: '‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ',
        userName: r.userName,
        testName: r.testName,
        score: r.score,
        maxScore: r.maxScore,
        passScore: r.passScore,
        passed: false,
        reviewer: getUserName(),
        reviewerNote: `–ü–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏–π: ${getUserName()} | –°—Ç–∞—Ç—É—Å: –í–Ü–î–•–ò–õ–ï–ù–û`
    });

    addNotif(`‚ùå –¢–µ—Å—Ç "${r.testName}" –±—ñ–π—Ü—è ${r.userName} –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ (${getUserName()})`);
    renderReview();
    updateHeader();
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-12: –ö–ï–†–£–í–ê–ù–ù–Ø
   ================================================================ */
function renderManage() {
    const tests = getTests();
    const results = getResults();

    let testsHTML = tests.map(t => {
        const tResults = results.filter(r => r.testId === t.id);
        const passed = tResults.filter(r => (r.status === 'approved') || (r.status === 'auto' && r.passed)).length;
        return `<tr>
            <td>${t.emoji} ${t.title}</td>
            <td>${t.questions ? t.questions.length : 0}</td>
            <td>${t.maxScore}</td>
            <td>${t.passScore}</td>
            <td>${tResults.length}</td>
            <td>${passed}</td>
            <td style="display:flex;gap:5px;flex-wrap:wrap;">
                <button class="btn-edit" onclick="editTest('${t.id}')">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                <button class="btn-danger" onclick="deleteTest('${t.id}')">üóë</button>
            </td>
        </tr>`;
    }).join('');

    document.getElementById('manageContent').innerHTML = `
        <div class="section-title">‚öôÔ∏è –ö–ï–†–£–í–ê–ù–ù–Ø –¢–ï–°–¢–ê–ú–ò</div>
        <div class="section-box" style="overflow-x:auto;">
            <table class="manage-table">
                <thead><tr><th>–¢–µ—Å—Ç</th><th>–ü–∏—Ç–∞–Ω—å</th><th>–ú–∞–∫—Å</th><th>–ü—Ä–æ—Ö—ñ–¥</th><th>–°–ø—Ä–æ–±</th><th>–°–∫–ª–∞–ª–∏</th><th>–î—ñ—ó</th></tr></thead>
                <tbody>${testsHTML || '<tr><td colspan="7" style="text-align:center;color:var(--text-gray);">–ù–µ–º–∞—î —Ç–µ—Å—Ç—ñ–≤</td></tr>'}</tbody>
            </table>
        </div>
        <div class="section-title" style="margin-top:30px;">üìä –í–°–Ü –†–ï–ó–£–õ–¨–¢–ê–¢–ò</div>
        <div class="section-box">
            <div id="allResultsList"></div>
            ${results.length > 0 ? '<button class="btn-danger" style="margin-top:15px;" onclick="clearAllResults()">üóë –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏</button>' : ''}
        </div>
    `;

    const allResList = document.getElementById('allResultsList');
    if (results.length === 0) {
        allResList.innerHTML = '<div style="color:var(--text-gray);text-align:center;padding:20px;">–ù–µ–º–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</div>';
    } else {
        allResList.innerHTML = results.sort((a, b) => b.date - a.date).map(r => {
            let statusClass = '', statusText = '';
            if (r.status === 'pending') { statusClass = 'ri-pending'; statusText = '‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞'; }
            else if (r.status === 'approved') { statusClass = 'ri-approved'; statusText = '‚úÖ –°—Ö–≤–∞–ª–µ–Ω–æ'; }
            else if (r.status === 'rejected') { statusClass = 'ri-rejected'; statusText = '‚ùå –í—ñ–¥—Ö–∏–ª–µ–Ω–æ'; }
            else { statusClass = r.passed ? 'ri-passed' : 'ri-failed'; statusText = r.passed ? '‚úÖ –°–∫–ª–∞–≤' : '‚ùå –ù–µ —Å–∫–ª–∞–≤'; }
            const reviewer = r.reviewer ? `<span class="reviewer-name">| ${r.reviewer}</span>` : '';
            return `<div class="result-item">
                <span class="ri-name">${r.userName}</span>
                <span style="color:var(--text-gray);font-size:12px;">${r.testName}</span>
                <span class="ri-score">${r.score}/${r.maxScore}</span>
                <span class="ri-status ${statusClass}">${statusText}</span>
                ${reviewer}
                <span class="ri-date">${new Date(r.date).toLocaleString('uk-UA')}</span>
                <button class="btn-danger" style="padding:5px 10px;font-size:10px;" onclick="deleteResult('${r.id}')">√ó</button>
            </div>`;
        }).join('');
    }
}

function editTest(testId) {
    const test = getTests().find(t => t.id === testId);
    if (!test) return;
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    document.getElementById('viewCreate').classList.add('active');
    renderCreateForm(test);
}

function deleteTest(testId) {
    if (!confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π —Ç–µ—Å—Ç?')) return;
    let tests = getTests();
    tests = tests.filter(t => t.id !== testId);
    saveTests(tests);
    renderManage();
}

function deleteResult(resId) {
    let results = getResults();
    results = results.filter(r => r.id !== resId);
    saveResults(results);
    renderManage();
}

function clearAllResults() {
    if (!confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –í–°–Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏?')) return;
    saveResults([]);
    renderManage();
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-13: –ù–ê–°–¢–†–û–ô–ö–ò
   ================================================================ */
function renderSettings() {
    const webhook = getWebhook();
    const checkers = getCheckers();
    const users = getUsers();

    let checkersHTML = checkers.map((c, i) => {
        return `<div class="checker-item">
            <div>
                <span class="name">${c.name}</span>
                <span class="role-tag" style="margin-left:8px;background:${c.role === 'admin' ? 'var(--primary)' : (c.role === 'instructor' ? 'rgba(251,191,36,0.2)' : 'rgba(255,255,255,0.1)')};color:${c.role === 'admin' ? 'black' : (c.role === 'instructor' ? 'var(--warning)' : 'var(--text-gray)')};">${c.role === 'admin' ? '–ê–î–ú–Ü–ù' : (c.role === 'instructor' ? '–Ü–ù–°–¢–†–£–ö–¢–û–†' : '–ë–Ü–Ñ–¶–¨')}</span>
            </div>
            <button class="btn-remove-checker" onclick="removeChecker(${i})">√ó</button>
        </div>`;
    }).join('') || '<div style="color:var(--text-gray);font-size:12px;padding:10px;">–ü–µ—Ä–µ–≤—ñ—Ä—é–≤–∞—á—ñ–≤ –Ω–µ –¥–æ–¥–∞–Ω–æ</div>';

    document.getElementById('settingsContent').innerHTML = `
        <div class="section-title">üîß –ù–ê–°–¢–†–û–ô–ö–ò</div>
        <div class="settings-grid">
            <div class="section-box">
                <h4 style="color:var(--primary-bright);margin-bottom:15px;font-size:14px;">üîó Discord Webhook</h4>
                <div class="form-group">
                    <label class="form-label">URL –í–µ–±—Ö—É–∫–∞</label>
                    <input class="form-input" id="settingsWebhook" value="${webhook}" placeholder="https://discord.com/api/webhooks/...">
                </div>
                <button class="btn-primary" style="width:100%;" onclick="saveWebhookSetting()">üíæ –ó–ë–ï–†–ï–ì–¢–ò</button>
                ${webhook ? '<button class="btn-secondary" style="width:100%;margin-top:8px;" onclick="testWebhook()">üß™ –¢–ï–°–¢ –í–ï–ë–•–£–ö–ê</button>' : ''}
            </div>
            <div class="section-box">
                <h4 style="color:var(--primary-bright);margin-bottom:15px;font-size:14px;">üë• –ü–µ—Ä–µ–≤—ñ—Ä—é–≤–∞—á—ñ —Ç–µ—Å—Ç—ñ–≤</h4>
                <div id="checkersList">${checkersHTML}</div>
                <div style="margin-top:15px;">
                    <label class="form-label">–î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä—é–≤–∞—á–∞</label>
                    <div class="search-input-wrap">
                        <input class="form-input" id="checkerSearch" placeholder="–ü–æ—à—É–∫ –ª—é–¥–∏–Ω–∏..." oninput="filterUsersDropdown(this.value)" onfocus="openUsersDropdown()">
                        <div class="user-select-dropdown" id="usersDropdown"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="section-box" style="margin-top:20px;">
            <h4 style="color:var(--primary-bright);margin-bottom:15px;font-size:14px;">üë§ –í–∞—à –ø—Ä–æ—Ñ—ñ–ª—å</h4>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–í–∞—à–µ —ñ–º'—è</label>
                    <input class="form-input" id="settingsName" value="${getUserName()}">
                </div>
                <div class="form-group">
                    <label class="form-label">–†–æ–ª—å</label>
                    <select class="form-select" id="settingsRole" onchange="changeRole(this.value)">
                        <option value="fighter" ${getRole() === 'fighter' ? 'selected' : ''}>–ë—ñ—î—Ü—å</option>
                        <option value="instructor" ${getRole() === 'instructor' ? 'selected' : ''}>–Ü–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</option>
                        <option value="admin" ${getRole() === 'admin' ? 'selected' : ''}>–ê–¥–º—ñ–Ω</option>
                    </select>
                </div>
            </div>
            <button class="btn-primary" onclick="saveProfileSettings()">üíæ –ó–ë–ï–†–ï–ì–¢–ò –ü–†–û–§–Ü–õ–¨</button>
        </div>
        <div class="section-box" style="margin-top:20px;">
            <h4 style="color:var(--primary-bright);margin-bottom:15px;font-size:14px;">üìã –°–ø–∏—Å–æ–∫ –ª—é–¥–µ–π</h4>
            <div id="usersListManage"></div>
            <div style="margin-top:15px;display:flex;gap:10px;">
                <input class="form-input" id="newUserName" placeholder="–Ü–º'—è –Ω–æ–≤–æ—ó –ª—é–¥–∏–Ω–∏" style="flex:1;">
                <select class="form-select" id="newUserRole" style="width:150px;">
                    <option value="fighter">–ë—ñ—î—Ü—å</option>
                    <option value="instructor">–Ü–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä</option>
                    <option value="admin">–ê–¥–º—ñ–Ω</option>
                </select>
                <button class="btn-primary" onclick="addNewUser()">+</button>
            </div>
        </div>
    `;

    renderUsersList();
}

function renderUsersList() {
    const users = getUsers();
    const el = document.getElementById('usersListManage');
    if (!el) return;
    el.innerHTML = users.map((u, i) => {
        const roleColor = u.role === 'admin' ? 'var(--primary)' : (u.role === 'instructor' ? 'var(--warning)' : 'var(--text-gray)');
        const roleName = u.role === 'admin' ? '–ê–¥–º—ñ–Ω' : (u.role === 'instructor' ? '–Ü–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä' : '–ë—ñ—î—Ü—å');
        return `<div class="checker-item">
            <div>
                <span class="name">${u.name}</span>
                <span class="role-tag" style="margin-left:8px;color:${roleColor};border:1px solid ${roleColor};background:none;padding:2px 8px;border-radius:5px;font-size:10px;">${roleName}</span>
            </div>
            <button class="btn-remove-checker" onclick="removeUser(${i})">√ó</button>
        </div>`;
    }).join('') || '<div style="color:var(--text-gray);font-size:12px;">–ù–µ–º–∞—î –ª—é–¥–µ–π</div>';
}

function addNewUser() {
    const name = document.getElementById('newUserName').value.trim();
    const role = document.getElementById('newUserRole').value;
    if (!name) return;
    const users = getUsers();
    if (users.some(u => u.name === name)) { alert('–¶—è –ª—é–¥–∏–Ω–∞ –≤–∂–µ —î!'); return; }
    users.push({ name, role });
    saveUsers(users);
    document.getElementById('newUserName').value = '';
    renderUsersList();
}

function removeUser(idx) {
    const users = getUsers();
    users.splice(idx, 1);
    saveUsers(users);
    renderUsersList();
}

function saveWebhookSetting() {
    const url = document.getElementById('settingsWebhook').value.trim();
    setWebhook(url);
    alert('–í–µ–±—Ö—É–∫ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!');
}

function testWebhook() {
    sendWebhook({
        title: 'üß™ –¢–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è',
        userName: getUserName(),
        testName: '–¢–µ—Å—Ç –≤–µ–±—Ö—É–∫–∞',
        score: 10,
        maxScore: 12,
        passScore: 8,
        passed: true,
        reviewer: 'SYSTEM',
        reviewerNote: '–¶–µ —Ç–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–µ–±—Ö—É–∫–∞'
    });
    alert('–¢–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ!');
}

function removeChecker(idx) {
    const checkers = getCheckers();
    checkers.splice(idx, 1);
    saveCheckers(checkers);
    renderSettings();
}

function openUsersDropdown() {
    filterUsersDropdown(document.getElementById('checkerSearch').value);
    document.getElementById('usersDropdown').classList.add('open');
}

function filterUsersDropdown(val) {
    const users = getUsers();
    const checkers = getCheckers();
    const filtered = users.filter(u =>
        u.name.toLowerCase().includes(val.toLowerCase()) &&
        !checkers.some(c => c.name === u.name)
    );
    const dd = document.getElementById('usersDropdown');
    if (filtered.length === 0) {
        dd.innerHTML = '<div style="padding:12px;color:var(--text-gray);font-size:12px;text-align:center;">–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>';
    } else {
        dd.innerHTML = filtered.map(u => {
            const roleName = u.role === 'admin' ? '–ê–¥–º—ñ–Ω' : (u.role === 'instructor' ? '–Ü–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä' : '–ë—ñ—î—Ü—å');
            return `<div class="user-select-item" onclick="selectChecker('${u.name}', '${u.role}')">
                <span>${u.name}</span>
                <span style="font-size:10px;color:var(--text-gray);">${roleName}</span>
            </div>`;
        }).join('');
    }
    dd.classList.add('open');
}

function selectChecker(name, role) {
    const checkers = getCheckers();
    if (checkers.some(c => c.name === name)) return;
    checkers.push({ name, role });
    saveCheckers(checkers);
    document.getElementById('checkerSearch').value = '';
    document.getElementById('usersDropdown').classList.remove('open');
    renderSettings();
}

document.addEventListener('click', (e) => {
    if (!e.target.closest('.search-input-wrap')) {
        const dd = document.getElementById('usersDropdown');
        if (dd) dd.classList.remove('open');
    }
});

function changeRole(newRole) {
    setRole(newRole);
    updateHeader();
}

function saveProfileSettings() {
    const name = document.getElementById('settingsName').value.trim();
    const role = document.getElementById('settingsRole').value;
    if (name) setUserName(name);
    setRole(role);
    updateHeader();
    alert('–ü—Ä–æ—Ñ—ñ–ª—å –∑–±–µ—Ä–µ–∂–µ–Ω–æ!');
}

/* ================================================================
   –ß–ê–°–¢–ò–ù–ê JS-14: –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø
   ================================================================ */
function init() {
    initDefaultUsers();
    initDefaultTests();
    updateHeader();
    renderHome();
    renderNotifs();
}

init();
</script>
</body>
</html>
