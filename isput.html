<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–î–®–í | –Ü–°–ü–ò–¢ –¶–ï–ù–¢–†</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 1: CSS –ó–ú–Ü–ù–ù–Ü –¢–ê –ë–ê–ó–û–í–Ü ====== */
        /* ============================================ */
        :root {
            --primary: #00ff44;
            --primary-bright: #e0ffe8;
            --primary-glow: rgba(0, 255, 68, 0.7);
            --bg: #030507;
            --card-bg: rgba(10, 12, 16, 0.6);
            --glass-border: rgba(0, 255, 68, 0.3);
            --danger: #ef4444;
            --danger-glow: rgba(239, 68, 68, 0.6);
            --warning: #fbbf24;
            --text-gray: #94a3b8;
        }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            background-image:
                radial-gradient(circle at 15% 50%, rgba(0, 255, 68, 0.25), transparent 50%),
                radial-gradient(circle at 85% 30%, rgba(0, 255, 68, 0.25), transparent 50%);
            background-size: 100% 100%;
            background-attachment: fixed;
            color: white;
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        * { box-sizing: border-box; }
        input, textarea, select { user-select: text !important; -webkit-user-select: text !important; }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #05070a; }
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
            box-shadow: 0 0 10px var(--primary);
        }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 2: –ê–ù–Ü–ú–ê–¶–Ü–á ================== */
        /* ============================================ */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes modalPop {
            from { transform: scale(0.85); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes pulseGlow {
            0% { box-shadow: 0 0 15px rgba(0, 255, 68, 0.3); }
            50% { box-shadow: 0 0 30px rgba(0, 255, 68, 0.6); }
            100% { box-shadow: 0 0 15px rgba(0, 255, 68, 0.3); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 3: –®–ê–ü–ö–ê (HEADER) ============ */
        /* ============================================ */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 5%; background: rgba(3, 5, 7, 0.85);
            border-bottom: 1px solid var(--glass-border);
            position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 0 20px rgba(0, 255, 102, 0.2);
            backdrop-filter: blur(10px);
        }
        .logo-box {
            background: var(--primary); color: black; padding: 6px 14px;
            border-radius: 8px; font-weight: 900; text-decoration: none; font-size: 14px;
            text-transform: uppercase; box-shadow: 0 0 20px var(--primary);
            letter-spacing: 1px; cursor: pointer; display: inline-block;
            transition: all 0.3s ease;
        }
        .logo-box:hover { box-shadow: 0 0 35px var(--primary); transform: translateY(-1px); }
        .header-right { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .btn-header {
            background: rgba(255,255,255, 0.05); border: 1px solid var(--primary);
            color: var(--primary-bright); padding: 8px 16px; border-radius: 10px;
            font-weight: 900; cursor: pointer; font-size: 12px;
            text-transform: uppercase; transition: all 0.3s ease;
        }
        .btn-header:hover {
            background: var(--primary); color: black;
            box-shadow: 0 0 15px var(--primary);
        }
        .btn-header.active { background: var(--primary); color: black; box-shadow: 0 0 15px var(--primary); }
        .btn-role-toggle {
            background: rgba(251, 191, 36, 0.15); border: 1px solid var(--warning);
            color: var(--warning); padding: 8px 16px; border-radius: 10px;
            font-weight: 900; cursor: pointer; font-size: 12px; transition: all 0.3s ease;
        }
        .btn-role-toggle.user-mode {
            background: rgba(255,255,255, 0.05); border: 1px solid #555; color: var(--text-gray);
        }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 4: –ö–ê–†–¢–ö–ò ==================== */
        /* ============================================ */
        .main-content { padding: 30px 5%; max-width: 1200px; margin: 0 auto; }

        .card {
            background: var(--card-bg); border: 1px solid var(--glass-border);
            border-radius: 20px; backdrop-filter: blur(10px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.4); padding: 25px;
            transition: all 0.3s ease; position: relative;
        }
        .card:hover {
            border-color: var(--primary);
            box-shadow: 0 0 30px rgba(0, 255, 68, 0.3), inset 0 0 15px rgba(0, 255, 68, 0.05);
            transform: translateY(-3px);
        }
        .card-hero {
            border: 1px solid var(--primary);
            box-shadow: 0 0 40px rgba(0, 255, 68, 0.15);
        }

        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; }
        .stat-box {
            background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 15px; text-align: center;
        }
        .stat-emoji { font-size: 24px; margin-bottom: 8px; }
        .stat-value { font-size: 24px; font-weight: 900; margin-bottom: 4px; text-shadow: 0 0 15px currentColor; }
        .stat-label { font-size: 10px; font-weight: 800; text-transform: uppercase; color: var(--text-gray); }

        .tests-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        .test-card { cursor: pointer; }
        .test-card .emoji-box {
            width: 56px; height: 56px; border-radius: 12px; display: flex;
            align-items: center; justify-content: center; font-size: 24px;
            background: rgba(0, 255, 68, 0.1); border: 1px solid rgba(0, 255, 68, 0.2);
        }
        .badge {
            padding: 4px 10px; border-radius: 8px; font-size: 10px;
            font-weight: 900; text-transform: uppercase;
        }
        .badge-green { background: rgba(0,255,68,0.1); color: var(--primary); border: 1px solid rgba(0,255,68,0.2); }
        .badge-yellow { background: rgba(251,191,36,0.1); color: var(--warning); border: 1px solid rgba(251,191,36,0.2); }
        .badge-red { background: rgba(239,68,68,0.1); color: var(--danger); border: 1px solid rgba(239,68,68,0.2); }

        .btn-start {
            background: var(--primary); color: black; padding: 8px 16px;
            border-radius: 8px; font-weight: 900; font-size: 12px;
            border: none; cursor: pointer; text-transform: uppercase;
            box-shadow: 0 0 10px rgba(0, 255, 68, 0.3); transition: all 0.3s ease;
        }
        .btn-start:hover { box-shadow: 0 0 25px var(--primary); }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 5: –†–ï–ó–£–õ–¨–¢–ê–¢–ò ================ */
        /* ============================================ */
        .result-item {
            background: var(--card-bg); border-radius: 12px; padding: 15px;
            display: flex; align-items: center; justify-content: space-between;
            margin-bottom: 10px; transition: all 0.3s ease;
        }
        .result-item.passed { border: 1px solid rgba(0,255,68,0.2); }
        .result-item.failed { border: 1px solid rgba(239,68,68,0.2); }

        .score-circle {
            width: 130px; height: 130px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; flex-direction: column;
            background: rgba(0,0,0,0.3);
        }
        .score-circle.passed { border: 4px solid var(--primary); box-shadow: 0 0 30px rgba(0,255,68,0.4); }
        .score-circle.failed { border: 4px solid var(--danger); box-shadow: 0 0 30px rgba(239,68,68,0.4); }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 6: –¢–ï–°–¢–£–í–ê–ù–ù–Ø ================ */
        /* ============================================ */
        .progress-bar-wrap {
            width: 100%; height: 8px; border-radius: 10px;
            background: rgba(255,255,255,0.05); overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%; border-radius: 10px;
            background: var(--primary); box-shadow: 0 0 10px var(--primary);
            transition: width 0.5s ease;
        }

        .answer-btn {
            display: flex; align-items: center; gap: 15px; padding: 15px;
            border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 14px;
            background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.08);
            color: white; width: 100%; text-align: left; transition: all 0.2s ease;
            margin-bottom: 10px;
        }
        .answer-btn:hover { border-color: rgba(0,255,68,0.5); background: rgba(0,255,68,0.05); }
        .answer-btn.selected { border-color: var(--primary); background: rgba(0,255,68,0.1); color: var(--primary-bright); }
        .answer-btn.correct { border-color: var(--primary); background: rgba(0,255,68,0.15); color: var(--primary-bright); }
        .answer-btn.wrong { border-color: var(--danger); background: rgba(239,68,68,0.15); color: #ff8888; }

        .letter-box {
            width: 32px; height: 32px; border-radius: 8px; display: flex;
            align-items: center; justify-content: center; font-weight: 900; font-size: 12px;
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            color: var(--text-gray); flex-shrink: 0; transition: all 0.2s ease;
        }
        .answer-btn.selected .letter-box { background: var(--primary); color: black; border-color: var(--primary); }

        .btn-confirm {
            padding: 15px 40px; border-radius: 12px; font-weight: 900; font-size: 14px;
            cursor: pointer; text-transform: uppercase; border: none; transition: all 0.3s ease;
        }
        .btn-confirm.active { background: var(--primary); color: black; box-shadow: 0 0 20px var(--primary); }
        .btn-confirm.disabled { background: rgba(255,255,255,0.05); color: #555; border: 1px solid #333; cursor: default; opacity: 0.5; }
        .btn-confirm.pulse { animation: pulseGlow 1.5s infinite; }

        .btn-cancel {
            background: none; color: var(--danger); border: 1px solid var(--danger);
            padding: 15px 25px; border-radius: 12px; font-weight: 900; font-size: 14px;
            cursor: pointer; text-transform: uppercase; transition: all 0.3s ease;
        }
        .btn-cancel:hover { background: var(--danger); color: white; }

        .btn-secondary {
            background: rgba(255,255,255,0.05); color: var(--primary);
            border: 1px solid var(--primary); padding: 12px 25px; border-radius: 12px;
            font-weight: 900; font-size: 13px; cursor: pointer; text-transform: uppercase;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover { background: var(--primary); color: black; box-shadow: 0 0 15px var(--primary); }

        .btn-danger {
            background: none; color: var(--danger); border: 1px solid var(--danger);
            padding: 10px 20px; border-radius: 10px; font-weight: 800; font-size: 12px;
            cursor: pointer; transition: all 0.3s ease;
        }
        .btn-danger:hover { background: var(--danger); color: white; }

        .timer-badge {
            padding: 5px 12px; border-radius: 8px; font-size: 12px; font-weight: 800;
        }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 7: –°–¢–í–û–†–ï–ù–ù–Ø –¢–ï–°–¢–£ =========== */
        /* ============================================ */
        .form-label {
            display: block; font-size: 11px; font-weight: 800; color: var(--text-gray);
            text-transform: uppercase; margin-bottom: 8px;
        }
        .form-input {
            width: 100%; background: #000; border: 1px solid #333; color: white;
            padding: 12px; border-radius: 10px; font-size: 14px; outline: none;
            font-family: 'Inter', sans-serif; transition: all 0.3s ease;
        }
        .form-input:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(0,255,68,0.3); }
        .form-select {
            width: 100%; background: #000; border: 1px solid #333; color: white;
            padding: 12px; border-radius: 10px; font-size: 14px; outline: none;
            font-family: 'Inter', sans-serif; cursor: pointer;
        }

        .correct-btn {
            width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-weight: 900; font-size: 11px;
            transition: all 0.3s ease; border: 2px solid #555;
            background: transparent; color: #555;
        }
        .correct-btn.active {
            background: var(--primary); border-color: var(--primary);
            color: black; box-shadow: 0 0 10px var(--primary);
        }

        .emoji-pick {
            width: 36px; height: 36px; border-radius: 8px; font-size: 18px;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            background: rgba(255,255,255,0.05); border: 1px solid #333; transition: all 0.3s ease;
        }
        .emoji-pick.active { background: var(--primary); border-color: var(--primary); }

        .error-box {
            background: rgba(239,68,68,0.1); border: 1px solid var(--danger);
            border-radius: 12px; padding: 15px; margin-bottom: 20px;
            color: var(--danger); font-size: 13px; font-weight: 700;
            animation: shake 0.3s ease;
        }

        .section-title {
            font-size: 18px; font-weight: 900; text-transform: uppercase;
            color: var(--primary-bright); text-shadow: 0 0 15px var(--primary);
            display: flex; align-items: center; gap: 10px; margin-bottom: 20px;
        }
        .section-title .accent { color: var(--primary); }

        .review-item {
            background: var(--card-bg); border-radius: 12px; padding: 18px; margin-bottom: 10px;
        }
        .review-item.correct-review { border-left: 4px solid var(--primary); border: 1px solid rgba(0,255,68,0.2); border-left-width: 4px; }
        .review-item.wrong-review { border-left: 4px solid var(--danger); border: 1px solid rgba(239,68,68,0.2); border-left-width: 4px; }

        .manage-item {
            background: var(--card-bg); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 12px; padding: 20px; margin-bottom: 12px;
            display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 15px;
            transition: all 0.3s ease;
        }
        .manage-item:hover { border-color: var(--glass-border); box-shadow: 0 0 20px rgba(0,255,68,0.1); }

        /* –§–£–¢–ï–† */
        footer {
            text-align: center; padding: 25px; margin-top: 40px;
            border-top: 1px solid rgba(0,255,68,0.1); color: var(--text-gray); font-size: 11px;
        }

        /* ============================================ */
        /* ===== –ß–ê–°–¢–ò–ù–ê 8: –ê–î–ê–ü–¢–ò–í–ù–Ü–°–¢–¨ ============== */
        /* ============================================ */
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .tests-grid { grid-template-columns: 1fr; }
            header { padding: 12px 15px; }
            .header-right { gap: 6px; }
            .btn-header, .btn-role-toggle { font-size: 10px; padding: 6px 10px; }
            .logo-box { font-size: 11px; padding: 5px 10px; }
            .main-content { padding: 20px 15px; }
            .manage-item { flex-direction: column; align-items: flex-start; }
        }

        /* –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –≤—Å—ñ –≤'—é—Ö–∏ –∫—Ä—ñ–º –∞–∫—Ç–∏–≤–Ω–æ–≥–æ */
        .view { display: none; }
        .view.active { display: block; }
    </style>
</head>
<body>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 9: HEADER HTML =============== -->
    <!-- ============================================ -->
    <header>
        <a href="cabinet.html" class="logo-box">–î–®–í</a>
        <div class="header-right">
            <button class="btn-header" id="btnHome" onclick="showView('home')">üè† –ì–û–õ–û–í–ù–ê</button>
            <button class="btn-header" id="btnCreate" onclick="showView('create')" style="display:none;">‚ûï –°–¢–í–û–†–ò–¢–ò</button>
            <button class="btn-header" id="btnManage" onclick="showView('manage')" style="display:none;">‚öôÔ∏è –ö–ï–†–£–í–ê–ù–ù–Ø</button>
            <button class="btn-role-toggle" id="btnRole" onclick="toggleRole()">üëë –ê–î–ú–Ü–ù</button>
        </div>
    </header>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 10: –ì–û–õ–û–í–ù–ê –°–¢–û–†–Ü–ù–ö–ê ========= -->
    <!-- ============================================ -->
    <div id="viewHome" class="view active">
        <div class="main-content">
            <!-- –ì–µ—Ä–æ–π –±–ª–æ–∫ -->
            <div class="card card-hero" style="margin-bottom: 25px; animation: fadeInUp 0.4s ease both;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <h1 style="font-size: 30px; font-weight: 900; text-transform: uppercase; color: var(--primary-bright); text-shadow: 0 0 20px var(--primary); letter-spacing: 2px; margin: 0 0 8px 0;">
                        üìã –Ü–°–ü–ò–¢ –¶–ï–ù–¢–†
                    </h1>
                    <p style="color: var(--text-gray); font-size: 13px; margin: 0;">
                        –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–Ω–∞–Ω—å –æ—Å–æ–±–æ–≤–æ–≥–æ —Å–∫–ª–∞–¥—É
                    </p>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-emoji">üìù</div>
                        <div class="stat-value" id="statTests" style="color: white;">0</div>
                        <div class="stat-label">–¢–ï–°–¢–Ü–í</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-emoji">‚úÖ</div>
                        <div class="stat-value" id="statPassed" style="color: var(--primary);">0</div>
                        <div class="stat-label">–°–ö–õ–ê–î–ï–ù–û</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-emoji">‚ùå</div>
                        <div class="stat-value" id="statFailed" style="color: var(--danger);">0</div>
                        <div class="stat-label">–ü–†–û–í–ê–õ–ï–ù–û</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-emoji">üìä</div>
                        <div class="stat-value" id="statAvg" style="color: var(--warning);">0%</div>
                        <div class="stat-label">–°–ï–†. –ë–ê–õ–ò</div>
                    </div>
                </div>
            </div>

            <!-- –ê–¥–º—ñ–Ω —ñ–Ω—Ñ–æ -->
            <div id="adminInfoBanner" style="display: none; background: rgba(251,191,36,0.05); border: 1px solid rgba(251,191,36,0.3); border-radius: 12px; padding: 15px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px; animation: fadeInUp 0.4s ease 0.1s both;">
                <span style="font-size: 24px;">üëë</span>
                <div>
                    <p style="font-size: 13px; font-weight: 800; color: var(--warning); margin: 0 0 3px 0;">–†–ï–ñ–ò–ú –ê–î–ú–Ü–ù–Ü–°–¢–†–ê–¢–û–†–ê</p>
                    <p style="font-size: 11px; color: var(--text-gray); margin: 0;">–í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏, —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ —Ç–µ—Å—Ç–∏</p>
                </div>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ —Ç–µ—Å—Ç—ñ–≤ -->
            <div style="margin-bottom: 25px;">
                <h2 class="section-title"><span class="accent">‚ñé</span> –î–û–°–¢–£–ü–ù–Ü –¢–ï–°–¢–ò</h2>
                <div id="testsGrid" class="tests-grid"></div>
                <div id="noTests" style="display: none; text-align: center; padding: 60px 20px;">
                    <p style="font-size: 50px; margin-bottom: 15px;">üì≠</p>
                    <p style="font-size: 16px; font-weight: 800; color: var(--text-gray);">–¢–µ—Å—Ç—ñ–≤ –ø–æ–∫–∏ –Ω–µ–º–∞—î</p>
                </div>
            </div>

            <!-- –û—Å—Ç–∞–Ω–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ -->
            <div id="resultsSection" style="display: none;">
                <h2 class="section-title"><span class="accent">‚ñé</span> –û–°–¢–ê–ù–ù–Ü –†–ï–ó–£–õ–¨–¢–ê–¢–ò</h2>
                <div id="resultsList"></div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 11: –Ü–ù–¢–†–û –¢–ï–°–¢–£ ============== -->
    <!-- ============================================ -->
    <div id="viewIntro" class="view">
        <div class="main-content" style="max-width: 700px;">
            <div class="card card-hero" style="text-align: center; animation: modalPop 0.4s ease;">
                <div id="introEmoji" style="font-size: 60px; margin-bottom: 15px;"></div>
                <h1 id="introTitle" style="font-size: 24px; font-weight: 900; text-transform: uppercase; color: var(--primary-bright); text-shadow: 0 0 15px var(--primary); margin: 0 0 10px 0;"></h1>
                <p id="introDesc" style="color: var(--text-gray); font-size: 13px; margin: 0 0 25px 0;"></p>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 30px;">
                    <div class="stat-box">
                        <div id="introCount" style="font-size: 20px; font-weight: 900; color: var(--primary-bright); margin-bottom: 3px;"></div>
                        <div class="stat-label">–ü–ò–¢–ê–ù–¨</div>
                    </div>
                    <div class="stat-box">
                        <div id="introPass" style="font-size: 20px; font-weight: 900; color: var(--primary-bright); margin-bottom: 3px;"></div>
                        <div class="stat-label">–ü–†–û–•–Ü–î–ù–ò–ô</div>
                    </div>
                    <div class="stat-box">
                        <div style="font-size: 20px; font-weight: 900; color: var(--primary-bright); margin-bottom: 3px;">30—Å</div>
                        <div class="stat-label">–ß–ê–°/–ü–ò–¢–ê–ù–ù–Ø</div>
                    </div>
                </div>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button class="btn-confirm active" onclick="startTest()" style="font-size: 14px;">üöÄ –ü–û–ß–ê–¢–ò –¢–ï–°–¢</button>
                    <button class="btn-cancel" onclick="showView('home')">–ù–ê–ó–ê–î</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 12: –ü–†–û–•–û–î–ñ–ï–ù–ù–Ø –¢–ï–°–¢–£ ======== -->
    <!-- ============================================ -->
    <div id="viewTest" class="view">
        <div class="main-content" style="max-width: 800px;">
            <!-- –ü—Ä–æ–≥—Ä–µ—Å -->
            <div style="margin-bottom: 20px; animation: fadeInUp 0.3s ease;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <span id="questionCounter" style="font-size: 12px; font-weight: 800; text-transform: uppercase; color: var(--primary);"></span>
                    <div id="timerBadge" class="timer-badge"></div>
                </div>
                <div class="progress-bar-wrap">
                    <div id="progressBar" class="progress-bar-fill" style="width: 0%;"></div>
                </div>
            </div>

            <!-- –ü–∏—Ç–∞–Ω–Ω—è -->
            <div id="questionCard" class="card" style="margin-bottom: 20px;">
                <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                    <div id="questionNumber" style="width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 14px; background: var(--primary); color: black;"></div>
                    <h2 id="questionText" style="font-size: 17px; font-weight: 700; color: var(--primary-bright); margin: 0;"></h2>
                </div>
                <div id="answersContainer"></div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div style="display: flex; justify-content: center; gap: 15px;">
                <button id="btnConfirmAnswer" class="btn-confirm disabled" onclick="confirmAnswer()">–ü–Ü–î–¢–í–ï–†–î–ò–¢–ò</button>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 13: –†–ï–ó–£–õ–¨–¢–ê–¢–ò =============== -->
    <!-- ============================================ -->
    <div id="viewResults" class="view">
        <div class="main-content" style="max-width: 700px;">
            <!-- –ì–µ—Ä–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç -->
            <div id="resultHero" class="card" style="text-align: center; margin-bottom: 25px; animation: modalPop 0.5s ease;">
                <div id="resultEmoji" style="font-size: 70px; margin-bottom: 15px;"></div>
                <h1 id="resultTitle" style="font-size: 28px; font-weight: 900; text-transform: uppercase; margin: 0 0 8px 0;"></h1>
                <p id="resultSubtitle" style="color: var(--text-gray); font-size: 13px; margin: 0 0 25px 0;"></p>

                <div style="display: flex; justify-content: center; margin-bottom: 25px;">
                    <div id="scoreCircle" class="score-circle">
                        <div id="scorePercent" style="font-size: 30px; font-weight: 900;"></div>
                        <div style="font-size: 10px; font-weight: 800; color: var(--text-gray);">–†–ï–ó–£–õ–¨–¢–ê–¢</div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 25px;">
                    <div class="stat-box">
                        <div id="resCorrect" style="font-size: 20px; font-weight: 900; color: var(--primary);"></div>
                        <div class="stat-label">–ü–†–ê–í–ò–õ–¨–ù–ò–•</div>
                    </div>
                    <div class="stat-box">
                        <div id="resWrong" style="font-size: 20px; font-weight: 900; color: var(--danger);"></div>
                        <div class="stat-label">–ü–û–ú–ò–õ–û–ö</div>
                    </div>
                    <div class="stat-box">
                        <div id="resPassReq" style="font-size: 20px; font-weight: 900; color: var(--warning);"></div>
                        <div class="stat-label">–ü–†–û–•–Ü–î–ù–ò–ô</div>
                    </div>
                </div>

                <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                    <button class="btn-secondary" onclick="retryTest()">üîÑ –ü–†–û–ô–¢–ò –ó–ù–û–í–£</button>
                    <button class="btn-confirm active" onclick="showView('home')">üè† –ù–ê –ì–û–õ–û–í–ù–£</button>
                </div>
            </div>

            <!-- –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä -->
            <h2 class="section-title"><span class="accent">‚ñé</span> –î–ï–¢–ê–õ–¨–ù–ò–ô –†–û–ó–ë–Ü–†</h2>
            <div id="reviewList"></div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 14: –°–¢–í–û–†–ï–ù–ù–Ø –¢–ï–°–¢–£ ========== -->
    <!-- ============================================ -->
    <div id="viewCreate" class="view">
        <div class="main-content" style="max-width: 800px;">
            <h1 class="section-title" style="animation: fadeInUp 0.4s ease;"><span class="accent">‚ñé</span> ‚ûï –°–¢–í–û–†–ï–ù–ù–Ø –¢–ï–°–¢–£</h1>

            <div id="createError" class="error-box" style="display: none;"></div>

            <!-- –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -->
            <div class="card" style="margin-bottom: 20px; animation: fadeInUp 0.4s ease 0.05s both;">
                <h3 style="font-size: 13px; font-weight: 900; text-transform: uppercase; color: var(--primary); margin: 0 0 18px 0;">–û–°–ù–û–í–ù–ê –Ü–ù–§–û–†–ú–ê–¶–Ü–Ø</h3>

                <div style="margin-bottom: 15px;">
                    <label class="form-label">–ù–∞–∑–≤–∞ —Ç–µ—Å—Ç—É</label>
                    <input type="text" id="cTitle" class="form-input" placeholder="–ù–∞–ø—Ä.: –ë–∞–∑–æ–≤–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –±—ñ–π—Ü—è">
                </div>
                <div style="margin-bottom: 15px;">
                    <label class="form-label">–û–ø–∏—Å</label>
                    <textarea id="cDesc" class="form-input" rows="3" placeholder="–ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å —Ç–µ—Å—Ç—É..." style="resize: none;"></textarea>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                    <div>
                        <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                        <select id="cCategory" class="form-select">
                            <option>–ë–∞–∑–æ–≤–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞</option>
                            <option>–¢–∞–∫—Ç–∏–∫–∞</option>
                            <option>–ú–µ–¥–∏—Ü–∏–Ω–∞</option>
                            <option>–ó–±—Ä–æ—è</option>
                            <option>–°—Ç–∞—Ç—É—Ç</option>
                            <option>–†–∞–¥—ñ–æ–∑–≤'—è–∑–æ–∫</option>
                            <option>–Ü–Ω—à–µ</option>
                        </select>
                    </div>
                    <div>
                        <label class="form-label">–ï–º–æ–¥–∑—ñ</label>
                        <div id="emojiPicker" style="display: flex; flex-wrap: wrap; gap: 5px;"></div>
                    </div>
                    <div>
                        <label class="form-label">–ü—Ä–æ—Ö—ñ–¥–Ω–∏–π –±–∞–ª: <span id="passScoreLabel">60</span>%</label>
                        <input type="range" id="cPassScore" min="10" max="100" step="5" value="60" style="width: 100%; accent-color: var(--primary); cursor: pointer;" oninput="document.getElementById('passScoreLabel').innerText=this.value">
                        <div style="display: flex; justify-content: space-between; font-size: 10px; color: var(--text-gray);"><span>10%</span><span>100%</span></div>
                    </div>
                </div>
            </div>

            <!-- –ü–∏—Ç–∞–Ω–Ω—è -->
            <h3 style="font-size: 13px; font-weight: 900; text-transform: uppercase; color: var(--primary); margin: 0 0 15px 0;">üìù –ü–ò–¢–ê–ù–ù–Ø (<span id="qCountLabel">1</span>)</h3>
            <div id="questionsContainer"></div>

            <button onclick="addQuestion()" style="width: 100%; padding: 15px; border-radius: 12px; font-weight: 900; font-size: 13px; cursor: pointer; background: rgba(0,255,68,0.05); border: 1px dashed var(--glass-border); color: var(--primary); text-transform: uppercase; margin-bottom: 25px; transition: all 0.3s ease;" onmouseenter="this.style.borderColor='var(--primary)'; this.style.boxShadow='0 0 20px rgba(0,255,68,0.2)';" onmouseleave="this.style.borderColor='var(--glass-border)'; this.style.boxShadow='none';">
                ‚ûï –î–û–î–ê–¢–ò –ü–ò–¢–ê–ù–ù–Ø
            </button>

            <div style="display: flex; gap: 12px; justify-content: center;">
                <button class="btn-confirm active" onclick="saveTest()">üíæ –ó–ë–ï–†–ï–ì–¢–ò –¢–ï–°–¢</button>
                <button class="btn-cancel" onclick="showView('home')">–°–ö–ê–°–£–í–ê–¢–ò</button>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 15: –ö–ï–†–£–í–ê–ù–ù–Ø –¢–ï–°–¢–ê–ú–ò ========= -->
    <!-- ============================================ -->
    <div id="viewManage" class="view">
        <div class="main-content" style="max-width: 900px;">
            <h1 class="section-title" style="animation: fadeInUp 0.4s ease;"><span class="accent">‚ñé</span> ‚öôÔ∏è –ö–ï–†–£–í–ê–ù–ù–Ø –¢–ï–°–¢–ê–ú–ò</h1>

            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px;">
                <div class="stat-box"><div id="mTests" class="stat-value" style="color: var(--primary); font-size: 22px;">0</div><div class="stat-label">–¢–ï–°–¢–Ü–í</div></div>
                <div class="stat-box"><div id="mQuestions" class="stat-value" style="color: var(--warning); font-size: 22px;">0</div><div class="stat-label">–ü–ò–¢–ê–ù–¨</div></div>
                <div class="stat-box"><div id="mResults" class="stat-value" style="color: var(--primary-bright); font-size: 22px;">0</div><div class="stat-label">–†–ï–ó–£–õ–¨–¢–ê–¢–Ü–í</div></div>
                <div class="stat-box"><div id="mSuccessRate" class="stat-value" style="color: var(--primary); font-size: 22px;">‚Äî</div><div class="stat-label">% –£–°–ü–Ü–•–£</div></div>
            </div>

            <div class="card" style="margin-bottom: 20px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 10px;">
                <span style="font-size: 13px; font-weight: 800; color: var(--text-gray);">üõ†Ô∏è –®–≤–∏–¥–∫—ñ –¥—ñ—ó</span>
                <div style="display: flex; gap: 8px;">
                    <button class="btn-danger" onclick="clearAllResults()">üóëÔ∏è –û–ß–ò–°–¢–ò–¢–ò –†–ï–ó–£–õ–¨–¢–ê–¢–ò</button>
                    <button class="btn-secondary" onclick="showView('home')" style="font-size: 12px; padding: 10px 18px;">üè† –ù–ê –ì–û–õ–û–í–ù–£</button>
                </div>
            </div>

            <h3 style="font-size: 13px; font-weight: 900; text-transform: uppercase; color: var(--primary); margin: 0 0 15px 0;">üìã –°–ü–ò–°–û–ö –¢–ï–°–¢–Ü–í</h3>
            <div id="manageList"></div>
            <div id="manageEmpty" style="display: none; text-align: center; padding: 60px; background: var(--card-bg); border: 1px dashed var(--glass-border); border-radius: 20px;">
                <p style="font-size: 50px;">üì≠</p>
                <p style="font-weight: 800; color: var(--text-gray);">–¢–µ—Å—Ç—ñ–≤ –Ω–µ–º–∞—î</p>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer>
        <span style="color: var(--primary); font-weight: 900;">–î–®–í</span> | –Ü–°–ü–ò–¢ –¶–ï–ù–¢–† ¬© <script>document.write(new Date().getFullYear())</script>
    </footer>

    <!-- ============================================ -->
    <!-- ===== –ß–ê–°–¢–ò–ù–ê 16: JAVASCRIPT =============== -->
    <!-- ============================================ -->
    <script>
        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.1: –°–•–û–í–ò–©–ï (localStorage)
        // =============================
        const TESTS_KEY = 'dsv_tests';
        const RESULTS_KEY = 'dsv_test_results';
        const ROLE_KEY = 'dsv_user_role';

        function getTests() {
            try {
                const d = localStorage.getItem(TESTS_KEY);
                if (d) return JSON.parse(d);
                const defaults = getDefaultTests();
                saveTests(defaults);
                return defaults;
            } catch(e) { return getDefaultTests(); }
        }
        function saveTests(tests) { localStorage.setItem(TESTS_KEY, JSON.stringify(tests)); }
        function getResults() {
            try { const d = localStorage.getItem(RESULTS_KEY); return d ? JSON.parse(d) : []; } catch(e) { return []; }
        }
        function saveResultToStorage(result) {
            const r = getResults(); r.unshift(result);
            localStorage.setItem(RESULTS_KEY, JSON.stringify(r));
        }
        function clearAllResults() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—é —ñ—Å—Ç–æ—Ä—ñ—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤?')) {
                localStorage.setItem(RESULTS_KEY, JSON.stringify([]));
                renderManage(); renderHome();
            }
        }
        function getRole() { return localStorage.getItem(ROLE_KEY) || 'user'; }
        function setRole(r) { localStorage.setItem(ROLE_KEY, r); }

        function getDefaultTests() {
            return [
                {
                    id: 'def1', title: '–ë–∞–∑–æ–≤–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –±—ñ–π—Ü—è', emoji: 'üéñÔ∏è',
                    description: '–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–∑–æ–≤–∏—Ö –∑–Ω–∞–Ω—å –∑ –≤—ñ–π—Å—å–∫–æ–≤–æ—ó –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ç–∞ —Å—Ç–∞—Ç—É—Ç—É –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É –î–®–í.',
                    category: '–ë–∞–∑–æ–≤–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞', passingScore: 60, createdAt: Date.now(), createdBy: '–°–∏—Å—Ç–µ–º–∞',
                    questions: [
                        { id:'q1', text:'–©–æ –æ–∑–Ω–∞—á–∞—î –∞–±—Ä–µ–≤—ñ–∞—Ç—É—Ä–∞ –î–®–í?', answers:[
                            {id:'a1',text:'–î–µ—Å–∞–Ω—Ç–Ω–æ-—à—Ç—É—Ä–º–æ–≤—ñ –≤—ñ–π—Å—å–∫–∞',isCorrect:true},
                            {id:'a2',text:'–î–∏–≤—ñ–∑—ñ–π–Ω—ñ —à—Ç–∞–±–Ω—ñ –≤—ñ–π—Å—å–∫–∞',isCorrect:false},
                            {id:'a3',text:'–î–æ–ø–æ–º—ñ–∂–Ω—ñ —à—Ç—É—Ä–º–æ–≤—ñ –≤—ñ–¥–¥—ñ–ª–∏',isCorrect:false},
                            {id:'a4',text:'–î–µ—Ä–∂–∞–≤–Ω–∞ —à—Ç—É—Ä–º–æ–≤–∞ –≤–∞—Ä—Ç–∞',isCorrect:false}
                        ]},
                        { id:'q2', text:'–Ø–∫–∏–π –∫–æ–ª—ñ—Ä –±–µ—Ä–µ—Ç—ñ –Ω–æ—Å—è—Ç—å –±—ñ–π—Ü—ñ –î–®–í?', answers:[
                            {id:'a1',text:'–ß–æ—Ä–Ω–∏–π',isCorrect:false},
                            {id:'a2',text:'–ú–∞—Ä—É–Ω–æ–≤–æ–≥–æ (–±–æ—Ä–¥–æ–≤–æ–≥–æ) –∫–æ–ª—å–æ—Ä—É',isCorrect:true},
                            {id:'a3',text:'–ó–µ–ª–µ–Ω–∏–π',isCorrect:false},
                            {id:'a4',text:'–°–∏–Ω—ñ–π',isCorrect:false}
                        ]},
                        { id:'q3', text:'–Ø–∫–µ –ø–µ—Ä—à–µ –ø—Ä–∞–≤–∏–ª–æ –±–µ–∑–ø–µ–∫–∏ –ø—Ä–∏ –ø–æ–≤–æ–¥–∂–µ–Ω–Ω—ñ –∑—ñ –∑–±—Ä–æ—î—é?', answers:[
                            {id:'a1',text:'–ó–∞–≤–∂–¥–∏ –≤–≤–∞–∂–∞—Ç–∏ –∑–±—Ä–æ—é –∑–∞—Ä—è–¥–∂–µ–Ω–æ—é',isCorrect:true},
                            {id:'a2',text:'–¢—Ä–∏–º–∞—Ç–∏ –ø–∞–ª–µ—Ü—å –Ω–∞ —Å–ø—É—Å–∫–æ–≤–æ–º—É –≥–∞—á–∫—É',isCorrect:false},
                            {id:'a3',text:'–ù–∞–ø—Ä–∞–≤–ª—è—Ç–∏ –∑–±—Ä–æ—é –Ω–∞ —Ü—ñ–ª—å',isCorrect:false},
                            {id:'a4',text:'–ó–Ω—è—Ç–∏ –∑ –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫–∞',isCorrect:false}
                        ]},
                        { id:'q4', text:'–©–æ —Ç–∞–∫–µ "–ø–æ–∑–∏–≤–Ω–∏–π" —É –≤—ñ–π—Å—å–∫–æ–≤–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ?', answers:[
                            {id:'a1',text:'–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É –±—ñ–π—Ü—è',isCorrect:false},
                            {id:'a2',text:'–ö–æ–¥–æ–≤–µ —ñ–º\'—è –¥–ª—è —Ä–∞–¥—ñ–æ–∑–≤\'—è–∑–∫—É',isCorrect:true},
                            {id:'a3',text:'–ó–≤–∞–Ω–Ω—è –±—ñ–π—Ü—è',isCorrect:false},
                            {id:'a4',text:'–ù–æ–º–µ—Ä –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—É',isCorrect:false}
                        ]},
                        { id:'q5', text:'–°–∫—ñ–ª—å–∫–∏ –±—ñ–π—Ü—ñ–≤ –∑–∞–∑–≤–∏—á–∞–π –≤—Ö–æ–¥—è—Ç—å –¥–æ —Å–∫–ª–∞–¥—É –≤—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è?', answers:[
                            {id:'a1',text:'3-5',isCorrect:false},
                            {id:'a2',text:'7-12',isCorrect:true},
                            {id:'a3',text:'20-30',isCorrect:false},
                            {id:'a4',text:'50+',isCorrect:false}
                        ]}
                    ]
                },
                {
                    id: 'def2', title: '–¢–∞–∫—Ç–∏—á–Ω–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞', emoji: '‚öîÔ∏è',
                    description: '–¢–µ—Å—Ç –Ω–∞ –∑–Ω–∞–Ω–Ω—è —Ç–∞–∫—Ç–∏—á–Ω–∏—Ö –¥—ñ–π —Ç–∞ –±–æ–π–æ–≤–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä.',
                    category: '–¢–∞–∫—Ç–∏–∫–∞', passingScore: 70, createdAt: Date.now()-86400000, createdBy: '–°–∏—Å—Ç–µ–º–∞',
                    questions: [
                        { id:'q1', text:'–©–æ —Ç–∞–∫–µ "—Å–µ–∫—Ç–æ—Ä –æ–±—Å—Ç—Ä—ñ–ª—É"?', answers:[
                            {id:'a1',text:'–ó–æ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –±—ñ–π—Ü—è –¥–ª—è –≤–µ–¥–µ–Ω–Ω—è –≤–æ–≥–Ω—é',isCorrect:true},
                            {id:'a2',text:'–°–∫–ª–∞–¥ –±–æ—î–ø—Ä–∏–ø–∞—Å—ñ–≤',isCorrect:false},
                            {id:'a3',text:'–¢–∏–ø –∑–±—Ä–æ—ó',isCorrect:false},
                            {id:'a4',text:'–ö–æ–º–∞–Ω–¥–∞ –¥–æ –≤—ñ–¥—Å—Ç—É–ø—É',isCorrect:false}
                        ]},
                        { id:'q2', text:'–Ø–∫–∞ —Ñ–æ—Ä–º–∞—Ü—ñ—è —Ä—É—Ö—É –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –≤–æ–≥–Ω—é?', answers:[
                            {id:'a1',text:'–ö–æ–ª–æ–Ω–∞',isCorrect:false},
                            {id:'a2',text:'–õ—ñ–Ω—ñ—è (—à–µ—Ä–µ–Ω–≥–∞)',isCorrect:true},
                            {id:'a3',text:'–ö–ª–∏–Ω',isCorrect:false},
                            {id:'a4',text:'–†–æ–º–±',isCorrect:false}
                        ]},
                        { id:'q3', text:'–©–æ –æ–∑–Ω–∞—á–∞—î –∫–æ–º–∞–Ω–¥–∞ "–ö–æ–Ω—Ç–∞–∫—Ç –ª—ñ–≤–∏–π"?', answers:[
                            {id:'a1',text:'–ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –ª—ñ–≤–æ—Ä—É—á',isCorrect:false},
                            {id:'a2',text:'–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –∑–ª—ñ–≤–∞',isCorrect:true},
                            {id:'a3',text:'–ó—É–ø–∏–Ω–∏—Ç–∏—Å—è',isCorrect:false},
                            {id:'a4',text:'–ü–µ—Ä–µ–∑–∞—Ä—è–¥–∏—Ç–∏ –∑–±—Ä–æ—é',isCorrect:false}
                        ]}
                    ]
                }
            ];
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.2: –ù–ê–í–Ü–ì–ê–¶–Ü–Ø
        // =============================
        let currentView = 'home';

        function showView(name) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById('view' + name.charAt(0).toUpperCase() + name.slice(1)).classList.add('active');
            currentView = name;
            window.scrollTo({top: 0, behavior: 'smooth'});

            // –ü—ñ–¥—Å–≤—ñ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.btn-header').forEach(b => b.classList.remove('active'));
            const btnMap = { home:'btnHome', create:'btnCreate', manage:'btnManage' };
            if (btnMap[name]) document.getElementById(btnMap[name]).classList.add('active');

            if (name === 'home') renderHome();
            if (name === 'create') initCreateView();
            if (name === 'manage') renderManage();
        }

        function updateRoleUI() {
            const role = getRole();
            const btn = document.getElementById('btnRole');
            const btnCreate = document.getElementById('btnCreate');
            const btnManage = document.getElementById('btnManage');
            const banner = document.getElementById('adminInfoBanner');

            if (role === 'admin') {
                btn.innerHTML = 'üëë –ê–î–ú–Ü–ù';
                btn.className = 'btn-role-toggle';
                btnCreate.style.display = 'inline-block';
                btnManage.style.display = 'inline-block';
                banner.style.display = 'flex';
            } else {
                btn.innerHTML = 'üë§ –ë–Ü–Ñ–¶–¨';
                btn.className = 'btn-role-toggle user-mode';
                btnCreate.style.display = 'none';
                btnManage.style.display = 'none';
                banner.style.display = 'none';
            }
        }

        function toggleRole() {
            setRole(getRole() === 'admin' ? 'user' : 'admin');
            updateRoleUI();
            renderHome();
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.3: –ì–û–õ–û–í–ù–ê –°–¢–û–†–Ü–ù–ö–ê
        // =============================
        function renderHome() {
            const tests = getTests();
            const results = getResults();

            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('statTests').innerText = tests.length;
            document.getElementById('statPassed').innerText = results.filter(r => r.passed).length;
            document.getElementById('statFailed').innerText = results.filter(r => !r.passed).length;
            const avg = results.length > 0 ? Math.round(results.reduce((s,r) => s + r.percentage, 0) / results.length) : 0;
            document.getElementById('statAvg').innerText = avg + '%';

            // –¢–µ—Å—Ç–∏
            const grid = document.getElementById('testsGrid');
            const noTests = document.getElementById('noTests');
            grid.innerHTML = '';

            if (tests.length === 0) {
                noTests.style.display = 'block';
                grid.style.display = 'none';
            } else {
                noTests.style.display = 'none';
                grid.style.display = 'grid';
                tests.forEach((test, i) => {
                    const card = document.createElement('div');
                    card.className = 'card test-card';
                    card.style.animation = `fadeInUp 0.4s ease ${i * 0.08}s both`;
                    card.onclick = () => openTestIntro(test.id);
                    card.innerHTML = `
                        <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:15px;">
                            <div class="emoji-box">${test.emoji}</div>
                            <span class="badge badge-green">${test.questions.length} –ø–∏—Ç–∞–Ω—å</span>
                        </div>
                        <h3 style="font-size:16px; font-weight:900; text-transform:uppercase; color:var(--primary-bright); text-shadow:0 0 10px rgba(0,255,68,0.3); margin:0 0 8px 0;">${test.title}</h3>
                        <p style="font-size:12px; color:var(--text-gray); margin:0 0 15px 0; line-height:1.5;">${test.description}</p>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div style="display:flex; gap:8px; align-items:center;">
                                <span class="badge badge-yellow">${test.category}</span>
                                <span style="font-size:10px; color:var(--text-gray);">–ü—Ä–æ—Ö—ñ–¥–Ω–∏–π: ${test.passingScore}%</span>
                            </div>
                            <div class="btn-start">–ü–†–û–ô–¢–ò ‚Üí</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }

            // –†–µ–∑—É–ª—å—Ç–∞—Ç–∏
            const resSection = document.getElementById('resultsSection');
            const resList = document.getElementById('resultsList');
            if (results.length > 0) {
                resSection.style.display = 'block';
                resList.innerHTML = '';
                results.slice(0, 5).forEach((r, i) => {
                    const item = document.createElement('div');
                    item.className = 'result-item ' + (r.passed ? 'passed' : 'failed');
                    item.style.animation = `fadeInUp 0.3s ease ${i * 0.05}s both`;
                    item.innerHTML = `
                        <div style="display:flex; align-items:center; gap:12px;">
                            <span style="font-size:24px;">${r.passed ? '‚úÖ' : '‚ùå'}</span>
                            <div>
                                <p style="font-size:13px; font-weight:800; margin:0 0 3px 0;">${r.testTitle}</p>
                                <p style="font-size:10px; color:var(--text-gray); margin:0;">${new Date(r.completedAt).toLocaleString('uk-UA')}</p>
                            </div>
                        </div>
                        <div style="font-size:18px; font-weight:900; padding:5px 15px; border-radius:8px; color:${r.passed?'var(--primary)':'var(--danger)'}; background:${r.passed?'rgba(0,255,68,0.1)':'rgba(239,68,68,0.1)'};">${r.percentage}%</div>
                    `;
                    resList.appendChild(item);
                });
            } else {
                resSection.style.display = 'none';
            }
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.4: –Ü–ù–¢–†–û –¢–ï–°–¢–£
        // =============================
        let activeTestId = null;

        function openTestIntro(testId) {
            const test = getTests().find(t => t.id === testId);
            if (!test) return;
            activeTestId = testId;
            document.getElementById('introEmoji').innerText = test.emoji;
            document.getElementById('introTitle').innerText = test.title;
            document.getElementById('introDesc').innerText = test.description;
            document.getElementById('introCount').innerText = test.questions.length;
            document.getElementById('introPass').innerText = test.passingScore + '%';
            showView('intro');
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.5: –ü–†–û–•–û–î–ñ–ï–ù–ù–Ø –¢–ï–°–¢–£
        // =============================
        let testState = {
            test: null, currentQ: 0, selectedAnswer: null,
            confirmed: false, answers: [], timeLeft: 30, timerInterval: null
        };

        function startTest() {
            const test = getTests().find(t => t.id === activeTestId);
            if (!test) return;
            testState = {
                test, currentQ: 0, selectedAnswer: null,
                confirmed: false, answers: [], timeLeft: 30, timerInterval: null
            };
            showView('test');
            renderQuestion();
            startTimer();
        }

        function renderQuestion() {
            const { test, currentQ, selectedAnswer, confirmed } = testState;
            const q = test.questions[currentQ];
            const progress = (currentQ / test.questions.length) * 100;

            document.getElementById('questionCounter').innerText = `–ü–∏—Ç–∞–Ω–Ω—è ${currentQ + 1} –∑ ${test.questions.length}`;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('questionNumber').innerText = currentQ + 1;
            document.getElementById('questionText').innerText = q.text;

            // –¢–∞–π–º–µ—Ä
            updateTimerDisplay();

            // –í—ñ–¥–ø–æ–≤—ñ–¥—ñ
            const container = document.getElementById('answersContainer');
            container.innerHTML = '';
            const correctAns = q.answers.find(a => a.isCorrect);

            q.answers.forEach((ans, idx) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                const letter = String.fromCharCode(65 + idx);

                if (confirmed) {
                    if (ans.id === correctAns.id) btn.classList.add('correct');
                    else if (ans.id === selectedAnswer && ans.id !== correctAns.id) btn.classList.add('wrong');
                } else if (selectedAnswer === ans.id) {
                    btn.classList.add('selected');
                }

                btn.style.animation = `slideIn 0.3s ease ${idx * 0.05}s both`;

                let icon = '';
                if (confirmed && ans.id === correctAns.id) icon = '<span style="margin-left:auto; font-size:18px;">‚úÖ</span>';
                if (confirmed && ans.id === selectedAnswer && ans.id !== correctAns.id) icon = '<span style="margin-left:auto; font-size:18px;">‚ùå</span>';

                btn.innerHTML = `
                    <div class="letter-box">${letter}</div>
                    <span style="flex:1;">${ans.text}</span>
                    ${icon}
                `;

                if (!confirmed) {
                    btn.onclick = () => selectAnswer(ans.id);
                }
                container.appendChild(btn);
            });

            // –ö–Ω–æ–ø–∫–∞
            const btnConfirm = document.getElementById('btnConfirmAnswer');
            if (confirmed) {
                btnConfirm.className = 'btn-confirm active pulse';
                btnConfirm.innerText = currentQ < test.questions.length - 1 ? '–î–ê–õ–Ü ‚Üí' : 'üèÅ –ó–ê–í–ï–†–®–ò–¢–ò';
                btnConfirm.onclick = nextQuestion;
            } else {
                btnConfirm.className = selectedAnswer ? 'btn-confirm active' : 'btn-confirm disabled';
                btnConfirm.innerText = '–ü–Ü–î–¢–í–ï–†–î–ò–¢–ò';
                btnConfirm.onclick = confirmAnswer;
            }
        }

        function selectAnswer(id) {
            if (testState.confirmed) return;
            testState.selectedAnswer = id;
            renderQuestion();
        }

        function confirmAnswer() {
            if (!testState.selectedAnswer || testState.confirmed) return;
            testState.confirmed = true;
            stopTimer();
            renderQuestion();
        }

        function nextQuestion() {
            const { test, currentQ, selectedAnswer } = testState;
            const q = test.questions[currentQ];
            const correctAns = q.answers.find(a => a.isCorrect);
            const isCorrect = selectedAnswer === correctAns.id;

            testState.answers.push({
                questionId: q.id,
                selectedAnswerId: selectedAnswer || '',
                isCorrect
            });

            if (currentQ < test.questions.length - 1) {
                testState.currentQ++;
                testState.selectedAnswer = null;
                testState.confirmed = false;
                testState.timeLeft = 30;
                renderQuestion();
                startTimer();
            } else {
                finishTest();
            }
        }

        function handleTimeUp() {
            const { test, currentQ } = testState;
            const q = test.questions[currentQ];
            testState.answers.push({
                questionId: q.id,
                selectedAnswerId: '',
                isCorrect: false
            });

            if (currentQ < test.questions.length - 1) {
                testState.currentQ++;
                testState.selectedAnswer = null;
                testState.confirmed = false;
                testState.timeLeft = 30;
                renderQuestion();
                startTimer();
            } else {
                finishTest();
            }
        }

        function startTimer() {
            stopTimer();
            testState.timeLeft = 30;
            updateTimerDisplay();
            testState.timerInterval = setInterval(() => {
                testState.timeLeft--;
                updateTimerDisplay();
                if (testState.timeLeft <= 0) {
                    stopTimer();
                    handleTimeUp();
                }
            }, 1000);
        }

        function stopTimer() {
            if (testState.timerInterval) {
                clearInterval(testState.timerInterval);
                testState.timerInterval = null;
            }
        }

        function updateTimerDisplay() {
            const badge = document.getElementById('timerBadge');
            const t = testState.timeLeft;
            const danger = t <= 10;
            badge.style.color = danger ? 'var(--danger)' : 'var(--warning)';
            badge.style.background = danger ? 'rgba(239,68,68,0.1)' : 'rgba(251,191,36,0.1)';
            badge.style.border = `1px solid ${danger ? 'rgba(239,68,68,0.3)' : 'rgba(251,191,36,0.3)'}`;
            badge.innerText = '‚è± ' + t + '—Å';
        }

        function finishTest() {
            stopTimer();
            const { test, answers } = testState;
            const correct = answers.filter(a => a.isCorrect).length;
            const percentage = Math.round((correct / test.questions.length) * 100);
            const passed = percentage >= test.passingScore;

            const result = {
                testId: test.id, testTitle: test.title,
                score: correct, totalQuestions: test.questions.length,
                percentage, passed, completedAt: Date.now(), answers
            };
            saveResultToStorage(result);
            renderResults(result);
            showView('results');
        }

        function retryTest() {
            if (activeTestId) {
                startTest();
            }
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.6: –†–ï–ó–£–õ–¨–¢–ê–¢–ò
        // =============================
        function renderResults(result) {
            const test = getTests().find(t => t.id === result.testId) || testState.test;
            const passed = result.passed;

            const hero = document.getElementById('resultHero');
            hero.style.border = `2px solid ${passed ? 'var(--primary)' : 'var(--danger)'}`;
            hero.style.boxShadow = `0 0 50px ${passed ? 'rgba(0,255,68,0.3)' : 'rgba(239,68,68,0.3)'}`;

            document.getElementById('resultEmoji').innerText = passed ? 'üéâ' : 'üòî';
            document.getElementById('resultTitle').innerText = passed ? '–¢–ï–°–¢ –°–ö–õ–ê–î–ï–ù–û!' : '–¢–ï–°–¢ –ù–ï –°–ö–õ–ê–î–ï–ù–û';
            document.getElementById('resultTitle').style.color = passed ? 'var(--primary-bright)' : '#ff8888';
            document.getElementById('resultTitle').style.textShadow = `0 0 20px ${passed ? 'var(--primary)' : 'var(--danger)'}`;
            document.getElementById('resultSubtitle').innerText = passed
                ? '–í—ñ—Ç–∞—î–º–æ! –í–∏ —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ–π—à–ª–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.'
                : '–ù–µ —Ö–≤–∏–ª—é–π—Ç–µ—Å—å, —Å–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –ø—ñ—Å–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏.';

            const circle = document.getElementById('scoreCircle');
            circle.className = 'score-circle ' + (passed ? 'passed' : 'failed');
            document.getElementById('scorePercent').innerText = result.percentage + '%';
            document.getElementById('scorePercent').style.color = passed ? 'var(--primary)' : 'var(--danger)';

            document.getElementById('resCorrect').innerText = result.score;
            document.getElementById('resWrong').innerText = result.totalQuestions - result.score;
            document.getElementById('resPassReq').innerText = (test ? test.passingScore : '?') + '%';

            // –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä
            const reviewList = document.getElementById('reviewList');
            reviewList.innerHTML = '';
            if (test) {
                test.questions.forEach((q, i) => {
                    const ua = result.answers[i];
                    const correctAns = q.answers.find(a => a.isCorrect);
                    const userAns = q.answers.find(a => a.id === (ua ? ua.selectedAnswerId : ''));

                    const item = document.createElement('div');
                    item.className = 'review-item ' + (ua && ua.isCorrect ? 'correct-review' : 'wrong-review');
                    item.style.animation = `fadeInUp 0.3s ease ${i * 0.05}s both`;

                    let answerInfo = '';
                    if (userAns) {
                        answerInfo = `<p style="font-size:12px; margin:0 0 3px 0; color:${ua.isCorrect ? 'var(--primary)' : 'var(--danger)'};">–í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${userAns.text}</p>`;
                    } else {
                        answerInfo = `<p style="font-size:12px; margin:0 0 3px 0; color:var(--danger);">–ß–∞—Å –≤–∏–π—à–æ–≤ ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–µ –Ω–∞–¥–∞–Ω–æ</p>`;
                    }
                    if (!ua || !ua.isCorrect) {
                        answerInfo += `<p style="font-size:12px; margin:0; color:var(--primary);">–ü—Ä–∞–≤–∏–ª—å–Ω–∞: ${correctAns ? correctAns.text : '?'}</p>`;
                    }

                    item.innerHTML = `
                        <div style="display:flex; align-items:flex-start; gap:12px;">
                            <span style="font-size:18px;">${ua && ua.isCorrect ? '‚úÖ' : '‚ùå'}</span>
                            <div style="flex:1;">
                                <p style="font-size:13px; font-weight:700; margin:0 0 8px 0;">${q.text}</p>
                                ${answerInfo}
                            </div>
                        </div>
                    `;
                    reviewList.appendChild(item);
                });
            }
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.7: –°–¢–í–û–†–ï–ù–ù–Ø –¢–ï–°–¢–£
        // =============================
        const EMOJIS = ['üìã','‚öîÔ∏è','üéñÔ∏è','üè¥','üìñ','üß†','üí£','üéØ','üî´','üó∫Ô∏è','üè•','üì°','üõ°Ô∏è','‚≠ê'];
        let createQuestions = [];
        let selectedEmoji = 'üìã';

        function initCreateView() {
            document.getElementById('cTitle').value = '';
            document.getElementById('cDesc').value = '';
            document.getElementById('cCategory').value = '–ë–∞–∑–æ–≤–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞';
            document.getElementById('cPassScore').value = 60;
            document.getElementById('passScoreLabel').innerText = '60';
            document.getElementById('createError').style.display = 'none';
            selectedEmoji = 'üìã';
            createQuestions = [makeEmptyQuestion()];
            renderEmojiPicker();
            renderCreateQuestions();
        }

        function renderEmojiPicker() {
            const picker = document.getElementById('emojiPicker');
            picker.innerHTML = '';
            EMOJIS.forEach(e => {
                const btn = document.createElement('button');
                btn.className = 'emoji-pick' + (selectedEmoji === e ? ' active' : '');
                btn.innerText = e;
                btn.onclick = () => { selectedEmoji = e; renderEmojiPicker(); };
                picker.appendChild(btn);
            });
        }

        function makeEmptyQuestion() {
            return {
                id: genId(), text: '',
                answers: [
                    { id: genId(), text: '', isCorrect: false },
                    { id: genId(), text: '', isCorrect: false },
                    { id: genId(), text: '', isCorrect: false },
                    { id: genId(), text: '', isCorrect: false }
                ]
            };
        }

        function genId() { return Math.random().toString(36).substr(2, 8) + Date.now().toString(36); }

        function renderCreateQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            document.getElementById('qCountLabel').innerText = createQuestions.length;

            createQuestions.forEach((q, qi) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.style.marginBottom = '15px';
                card.style.animation = 'fadeInUp 0.3s ease';

                let answersHTML = '';
                q.answers.forEach((a, ai) => {
                    const letter = String.fromCharCode(65 + ai);
                    answersHTML += `
                        <div style="display:flex; align-items:center; gap:8px; margin-bottom:8px;">
                            <button class="correct-btn ${a.isCorrect ? 'active' : ''}" onclick="setCorrect(${qi},${ai})">${a.isCorrect ? '‚úì' : letter}</button>
                            <input type="text" class="form-input" value="${escHtml(a.text)}" placeholder="–í–∞—Ä—ñ–∞–Ω—Ç ${letter}..."
                                style="flex:1; padding:10px; font-size:13px; border-color:${a.isCorrect ? 'var(--primary)' : '#333'};"
                                oninput="updateAnswerText(${qi},${ai},this.value)"
                                onfocus="this.style.borderColor='var(--primary)'"
                                onblur="this.style.borderColor='${a.isCorrect ? 'var(--primary)' : '#333'}'">
                            ${q.answers.length > 2 ? `<button onclick="removeAnswer(${qi},${ai})" style="width:28px; height:28px; border-radius:8px; background:rgba(239,68,68,0.1); color:var(--danger); border:1px solid rgba(239,68,68,0.2); cursor:pointer; font-size:12px; flex-shrink:0;">‚úï</button>` : ''}
                        </div>
                    `;
                });

                card.innerHTML = `
                    <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:15px;">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <div style="width:32px; height:32px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:12px; background:var(--primary); color:black;">${qi+1}</div>
                            <span style="font-size:13px; font-weight:800; color:var(--primary-bright);">–ü–∏—Ç–∞–Ω–Ω—è ${qi+1}</span>
                        </div>
                        ${createQuestions.length > 1 ? `<button class="btn-danger" onclick="removeQuestion(${qi})" style="font-size:11px; padding:6px 12px;">üóëÔ∏è –í–ò–î–ê–õ–ò–¢–ò</button>` : ''}
                    </div>
                    <input type="text" class="form-input" value="${escHtml(q.text)}" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è..."
                        style="margin-bottom:15px;" oninput="updateQuestionText(${qi},this.value)"
                        onfocus="this.style.borderColor='var(--primary)'" onblur="this.style.borderColor='#333'">
                    <label class="form-label" style="font-size:10px;">–í–ê–†–Ü–ê–ù–¢–ò –í–Ü–î–ü–û–í–Ü–î–ï–ô (–∫–ª—ñ–∫–Ω—ñ—Ç—å –∫—Ä—É–∂–æ–∫ —â–æ–± –æ–±—Ä–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É)</label>
                    ${answersHTML}
                    ${q.answers.length < 6 ? `<button onclick="addAnswerTo(${qi})" style="font-size:11px; font-weight:800; padding:6px 12px; border-radius:8px; cursor:pointer; background:rgba(0,255,68,0.05); color:var(--primary); border:1px dashed rgba(0,255,68,0.3); margin-top:5px;">+ –î–û–î–ê–¢–ò –í–ê–†–Ü–ê–ù–¢</button>` : ''}
                `;
                container.appendChild(card);
            });
        }

        function escHtml(s) { return (s||'').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

        function updateQuestionText(qi, val) { createQuestions[qi].text = val; }
        function updateAnswerText(qi, ai, val) { createQuestions[qi].answers[ai].text = val; }
        function setCorrect(qi, ai) {
            createQuestions[qi].answers.forEach((a, i) => a.isCorrect = (i === ai));
            renderCreateQuestions();
        }
        function removeAnswer(qi, ai) {
            if (createQuestions[qi].answers.length <= 2) return;
            createQuestions[qi].answers.splice(ai, 1);
            renderCreateQuestions();
        }
        function addAnswerTo(qi) {
            if (createQuestions[qi].answers.length >= 6) return;
            createQuestions[qi].answers.push({ id: genId(), text: '', isCorrect: false });
            renderCreateQuestions();
        }
        function addQuestion() {
            createQuestions.push(makeEmptyQuestion());
            renderCreateQuestions();
        }
        function removeQuestion(qi) {
            if (createQuestions.length <= 1) return;
            createQuestions.splice(qi, 1);
            renderCreateQuestions();
        }

        function saveTest() {
            const title = document.getElementById('cTitle').value.trim();
            const desc = document.getElementById('cDesc').value.trim();
            const category = document.getElementById('cCategory').value;
            const passScore = parseInt(document.getElementById('cPassScore').value);
            const errBox = document.getElementById('createError');

            function showErr(msg) { errBox.style.display = 'block'; errBox.innerText = '‚ö†Ô∏è ' + msg; window.scrollTo({top:0,behavior:'smooth'}); }

            if (!title) return showErr('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–µ—Å—Ç—É');
            if (!desc) return showErr('–í–≤–µ–¥—ñ—Ç—å –æ–ø–∏—Å —Ç–µ—Å—Ç—É');

            for (let i = 0; i < createQuestions.length; i++) {
                const q = createQuestions[i];
                if (!q.text.trim()) return showErr(`–ü–∏—Ç–∞–Ω–Ω—è ${i+1}: –≤–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –ø–∏—Ç–∞–Ω–Ω—è`);
                const filled = q.answers.filter(a => a.text.trim());
                if (filled.length < 2) return showErr(`–ü–∏—Ç–∞–Ω–Ω—è ${i+1}: –º—ñ–Ω—ñ–º—É–º 2 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ`);
                if (!q.answers.some(a => a.isCorrect)) return showErr(`–ü–∏—Ç–∞–Ω–Ω—è ${i+1}: –æ–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å`);
                const ca = q.answers.find(a => a.isCorrect);
                if (ca && !ca.text.trim()) return showErr(`–ü–∏—Ç–∞–Ω–Ω—è ${i+1}: –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø—É—Å—Ç–æ—é`);
            }

            errBox.style.display = 'none';

            const cleanQ = createQuestions.map(q => ({
                ...q, answers: q.answers.filter(a => a.text.trim())
            }));

            const newTest = {
                id: genId(), title, description: desc, questions: cleanQ,
                createdAt: Date.now(), createdBy: '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä',
                category, passingScore: passScore, emoji: selectedEmoji
            };

            const tests = getTests();
            tests.push(newTest);
            saveTests(tests);
            showView('home');
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.8: –ö–ï–†–£–í–ê–ù–ù–Ø
        // =============================
        function renderManage() {
            const tests = getTests();
            const results = getResults();

            document.getElementById('mTests').innerText = tests.length;
            document.getElementById('mQuestions').innerText = tests.reduce((s,t) => s + t.questions.length, 0);
            document.getElementById('mResults').innerText = results.length;

            if (results.length > 0) {
                const rate = Math.round((results.filter(r=>r.passed).length / results.length) * 100);
                document.getElementById('mSuccessRate').innerText = rate + '%';
            } else {
                document.getElementById('mSuccessRate').innerText = '‚Äî';
            }

            const list = document.getElementById('manageList');
            const empty = document.getElementById('manageEmpty');
            list.innerHTML = '';

            if (tests.length === 0) {
                empty.style.display = 'block';
                list.style.display = 'none';
            } else {
                empty.style.display = 'none';
                list.style.display = 'block';
                tests.forEach((test, i) => {
                    const tResults = results.filter(r => r.testId === test.id);
                    const passRate = tResults.length > 0 ? Math.round((tResults.filter(r=>r.passed).length / tResults.length) * 100) : null;

                    const item = document.createElement('div');
                    item.className = 'manage-item';
                    item.style.animation = `fadeInUp 0.3s ease ${i * 0.05}s both`;
                    item.innerHTML = `
                        <div style="display:flex; align-items:center; gap:15px;">
                            <div class="emoji-box" style="width:48px; height:48px; font-size:20px;">${test.emoji}</div>
                            <div>
                                <p style="font-size:13px; font-weight:800; margin:0 0 5px 0;">${test.title}</p>
                                <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap;">
                                    <span class="badge badge-yellow" style="font-size:9px;">${test.category}</span>
                                    <span style="font-size:10px; color:var(--text-gray);">${test.questions.length} –ø–∏—Ç–∞–Ω—å</span>
                                    <span style="font-size:10px; color:var(--text-gray);">–ü—Ä–æ—Ö—ñ–¥–Ω–∏–π: ${test.passingScore}%</span>
                                    ${passRate !== null ? `<span style="font-size:10px; color:${passRate >= 50 ? 'var(--primary)' : 'var(--danger)'};">–£—Å–ø—ñ—Ö: ${passRate}% (${tResults.length} —Å–ø—Ä–æ–±)</span>` : ''}
                                </div>
                            </div>
                        </div>
                        <div style="display:flex; gap:8px;">
                            <button class="btn-danger" onclick="deleteTestById('${test.id}','${escHtml(test.title)}')">üóëÔ∏è –í–ò–î–ê–õ–ò–¢–ò</button>
                        </div>
                    `;
                    list.appendChild(item);
                });
            }
        }

        function deleteTestById(id, title) {
            if (confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ—Å—Ç "' + title + '"? –¶—é –¥—ñ—é –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å–∫–∞—Å—É–≤–∞—Ç–∏.')) {
                const tests = getTests().filter(t => t.id !== id);
                saveTests(tests);
                renderManage();
                renderHome();
            }
        }

        // =============================
        // –ß–ê–°–¢–ò–ù–ê 16.9: –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø
        // =============================
        updateRoleUI();
        renderHome();
    </script>

</body>
</html>
